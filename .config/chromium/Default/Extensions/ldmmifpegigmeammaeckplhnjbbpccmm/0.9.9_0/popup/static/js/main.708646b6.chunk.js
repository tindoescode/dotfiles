(this.webpackJsonpoptions=this.webpackJsonpoptions||[]).push([[0],{120:function(e,t,n){},161:function(e,t,n){e.exports=n(190)},167:function(e,t,n){},190:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(18),o=n.n(c),i=(n(120),n(34)),l=n(2),u=n.n(l),s=n(19),p=n(6),d=n(8),m=n(9),f=n(13),h=(n(167),n(49)),b=n(16),g=(n(20),n(241),n(198).default,n(191).default),v=n(199).default,y=(n(200).default,n(195).default,n(193).default,n(55).default,n(72).default,n(123).default,n(192).default,n(201).default,n(41).default,n(56).default,n(82).default,n(42).makeStyles),E=n(42),x=(E.ThemeProvider,E.createMuiTheme,n(196).default),k=(n(202).default,n(203).default,n(204).default,n(205).default,n(206).default,n(207).default,n(208).default,n(42)),O=k.createStyles,C=k.withStyles,w=(n(209).default,n(210).default,{sm:"600px",md:"960px",lg:"1280px",xl:"1920px"}),j=function(e){var t=e.children,n=e.align,a=void 0===n?null:n,c=e.alignItems,o=void 0===c?null:c,i=e.justifyContent,l=void 0===i?null:i,u=e.justify,s=void 0===u?null:u,d=e.uppercase,m=void 0===d?null:d,f=e.style,h=Object(b.a)(e,["children","align","alignItems","justifyContent","justify","uppercase","style"]);return r.a.createElement(g,Object.assign({alignItems:a||o,justifyContent:s||l,style:Object(p.a)({textTransform:m?"uppercase":null},f)},h),t)},L=(C((function(e){return O({root:Object(h.a)({display:"flex",flexDirection:"column"},e.breakpoints.down("sm"),{flexDirection:"row"})})}))((function(e){var t=e.children,n=Object(b.a)(e,["children"]);return r.a.createElement(j,n,t)})),function(e){var t=e.children,n=e.size,a=void 0===n?"md":n,c=Object(b.a)(e,["children","size"]);return r.a.createElement(_,{width:"100%",height:"100%",justifyContent:"center"},r.a.createElement(j,Object.assign({flex:1,maxWidth:w[a]},c),t))}),S=(y({root:{background:"linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)",border:0,borderRadius:3,boxShadow:"0 3px 5px 2px rgba(255, 105, 135, .3)",color:"white",height:48,padding:"0 30px"}}),function(e){var t=e.children,n=(e.as,e.noWrap),a=Object(b.a)(e,["children","as","noWrap"]);return r.a.createElement(j,Object.assign({fontSize:"16px",fontWeight:"bold",whiteSpace:n&&"nowrap",overflow:n&&"hidden",textOverflow:n&&"ellipsis",color:"inherit"},a),t)}),F=function(e){var t=e.children,n=Object(b.a)(e,["children"]);return r.a.createElement(S,Object.assign({component:"h4",fontSize:"16px",fontWeight:"bold"},n),t)},I=function(e){var t=e.children,n=Object(b.a)(e,["children"]);return r.a.createElement(S,Object.assign({component:"h3",fontSize:"20px",fontWeight:"bold"},n),t)},T=function(e){var t=e.children,n=Object(b.a)(e,["children"]);return r.a.createElement(j,Object.assign({component:"span",color:"inherit"},n),t)},_=function(e){var t=e.children,n=Object(b.a)(e,["children"]);return r.a.createElement(j,Object.assign({display:"flex"},n),t)},M=function(e){var t=e.children,n=Object(b.a)(e,["children"]);return r.a.createElement(j,Object.assign({display:"flex",flexDirection:"column"},n),t)};function V(e){var t=r.a.useState({}),n=Object(m.a)(t,2),a=n[0],c=n[1],o=r.a.useState(!1),i=Object(m.a)(o,2),l=i[0],u=i[1],s=r.a.useState(0),d=Object(m.a)(s,2),f=(d[0],d[1]),b=r.a.useMemo((function(){return Object.keys(e).length}),[e]);return{allDone:l,setLoaded:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e in a)throw"already loaded ".concat(e);f((function(n){return c((function(n){return Object(p.a)(Object(p.a)({},n),{},Object(h.a)({},e,t))})),n+1==b&&u(!0),n+1}))},loadStates:a}}var P=function(e){var t=e.onClose,n=e.onOpen,a=e.children,c=r.a.useState(!1),o=Object(m.a)(c,2),i=o[0],l=o[1];return r.a.createElement(r.a.Fragment,null,a({handleOpen:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l(!0),e.t0=n,!e.t0){e.next=5;break}return e.next=5,n();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),handleClose:function(){var e=Object(d.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l(!1),e.t0=t,!e.t0){e.next=5;break}return e.next=5,t(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isOpen:i}))},D="STORAGE_KEY_FORM_LIST",N={default:"rgba(206, 205, 202, 0.5)",gray:"rgba(155, 154, 151, 0.4)",brown:"rgba(140, 46, 0, 0.2)",yellow:"rgba(233, 168, 0, 0.2)",green:"rgba(0, 135, 107, 0.2)",orange:"rgba(245, 93, 0, 0.2)",blue:"rgba(0, 120, 223, 0.2)",purple:"rgba(103, 36, 222, 0.2)",pink:"rgba(221, 0, 129, 0.2)",red:"rgba(255, 0, 26, 0.2)"};function R(){return Object.keys(N)[Math.floor(Math.random()*Object.keys(N).length)]}function z(e,t){return new Promise((function(n,a){e(t,n)}))}function U(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=n.length,r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*a));return t}var B=function(){},Z=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function H(e,t){var n,a,r;return function(){for(var c=arguments.length,o=new Array(c),i=0;i<c;i++)o[i]=arguments[i];var l=new Date;return a&&(a(void 0),clearTimeout(r),a=null),new Promise((function(c){var i=n?Math.max(0,t-(l.getTime()-n.getTime())):0;a=c,r=setTimeout((function(){n=l,a=null,c(e.apply(null,o))}),i)}))}}function W(e){return e.color in N?N[e.color]:N.default}var A,G;function q(e,t){return 0===t?e:e+"_"+t}var J=(null===(A=chrome.storage.sync)||void 0===A?void 0:A.QUOTA_BYTES_PER_ITEM)||8192,K=(null===(G=chrome.storage.sync)||void 0===G?void 0:G.MAX_ITEMS)||512;function Y(e,t,n){for(var a,r,c=0,o={},i=JSON.stringify(t),l=[];i.length>0;)r=q(e,c),a=i.substr(0,J-r.length-2),l.push(a.length),o[r]=a,i=i.substr(J-r.length-2),c++;chrome.storage.local.set(o,n),chrome.storage.local.remove(q(e,c))}function X(e,t,n){chrome.storage.local.get(null,(function(a){var r,c="",o=!1;for(r=0;r<K&&void 0!==a[q(e,r)];r++)o=!0,c+=a[q(e,r)];o?t(JSON.parse(c)):n()}))}function Q(){return(Q=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){X(t,(function(t){e(t)}),Object(d.a)(u.a.mark((function a(){return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return B("no value found, saving default"),a.next=3,$(t,n);case 3:e(n);case 4:case"end":return a.stop()}}),a)}))))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:new Promise((function(e){Y(t,n,(function(){e()}))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var te={set:$,get:function(e,t){return Q.apply(this,arguments)}},ne=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"14px",height:"14px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M7,13 C10.31348,13 13,10.31371 13,7 C13,3.68629 10.31348,1 7,1 C3.68652,1 1,3.68629 1,7 C1,10.31371 3.68652,13 7,13 Z M3.75098,5.32278 C3.64893,5.19142 3.74268,5 3.90869,5 L10.09131,5 C10.25732,5 10.35107,5.19142 10.24902,5.32278 L7.15771,9.29703 C7.07764,9.39998 6.92236,9.39998 6.84229,9.29703 L3.75098,5.32278 Z"})))},ae=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"16px",height:"16px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M0,3 C0,1.34314 1.34326,0 3,0 L11,0 C12.6567,0 14,1.34314 14,3 L14,11 C14,12.6569 12.6567,14 11,14 L3,14 C1.34326,14 0,12.6569 0,11 L0,3 Z M3,1.5 C2.17139,1.5 1.5,2.17157 1.5,3 L1.5,11 C1.5,11.8284 2.17139,12.5 3,12.5 L11,12.5 C11.8286,12.5 12.5,11.8284 12.5,11 L12.5,3 C12.5,2.17157 11.8286,1.5 11,1.5 L3,1.5 Z M2.83252,6.8161 L3.39893,6.27399 L3.57617,6.10425 L3.92334,5.77216 L4.26904,6.10559 L4.44531,6.27582 L5.58398,7.37402 L9.28271,3.81073 L9.45996,3.64008 L9.80664,3.3056 L10.1538,3.63989 L10.3311,3.81067 L10.8936,4.35303 L11.0708,4.52399 L11.4434,4.88379 L11.0708,5.24353 L10.8936,5.41437 L6.1084,10.0291 L5.93115,10.2 L5.58398,10.5344 L5.23682,10.2 L5.05957,10.0292 L2.83057,7.87946 L2.65283,7.70801 L2.27832,7.34674 L2.6543,6.98694 L2.83252,6.8161 Z"})))},re=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"14px",height:"14px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M4,3 C4,2.447715 4.447715,2 5,2 L12,2 C12.5523,2 13,2.447716 13,3 C13,3.55228 12.5523,4 12,4 L5,4 C4.447715,4 4,3.55228 4,3 Z M4,7 C4,6.447715 4.447715,6 5,6 L12,6 C12.5523,6 13,6.447716 13,7 C13,7.55228 12.5523,8 12,8 L5,8 C4.447715,8 4,7.55228 4,7 Z M4,11 C4,10.447715 4.447715,10 5,10 L12,10 C12.5523,10 13,10.447716 13,11 C13,11.55228 12.5523,12 12,12 L5,12 C4.447715,12 4,11.55228 4,11 Z M2,4 C1.44771525,4 1,3.55228475 1,3 C1,2.44771525 1.44771525,2 2,2 C2.55228475,2 3,2.44771525 3,3 C3,3.55228475 2.55228475,4 2,4 Z M2,8 C1.44771525,8 1,7.55228475 1,7 C1,6.44771525 1.44771525,6 2,6 C2.55228475,6 3,6.44771525 3,7 C3,7.55228475 2.55228475,8 2,8 Z M2,12 C1.44771525,12 1,11.5522847 1,11 C1,10.4477153 1.44771525,10 2,10 C2.55228475,10 3,10.4477153 3,11 C3,11.5522847 2.55228475,12 2,12 Z"})))},ce=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"14px",height:"14px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"})))},oe=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"14px",height:"14px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"})))},ie=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"14px",height:"14px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M3.73333,3.86667 L7.46667,3.86667 C8.49613,3.86667 9.33333,4.70387 9.33333,5.73333 C9.33333,6.7628 8.49613,7.6 7.46667,7.6 L6.53333,7.6 C6.01813,7.6 5.6,8.0186 5.6,8.53333 C5.6,9.04807 6.01813,9.46667 6.53333,9.46667 L7.46667,9.46667 C9.5284,9.46667 11.2,7.79507 11.2,5.73333 C11.2,3.6716 9.5284,2 7.46667,2 L3.73333,2 C1.6716,2 0,3.6716 0,5.73333 C0,7.124 0.762067,8.33453 1.88953,8.97713 C1.87553,8.83107 1.86667,8.6836 1.86667,8.53333 C1.86667,7.92013 1.98753,7.33447 2.2036,6.7978 C1.99267,6.4954 1.86667,6.12953 1.86667,5.73333 C1.86667,4.70387 2.70387,3.86667 3.73333,3.86667 Z M12.1095,5.28907 C12.1231,5.4356 12.1333,5.58307 12.1333,5.73333 C12.1333,6.34607 12.0101,6.9294 11.7931,7.46513 C12.0059,7.768 12.1333,8.13573 12.1333,8.53333 C12.1333,9.5628 11.2961,10.4 10.2667,10.4 L6.53333,10.4 C5.50387,10.4 4.66667,9.5628 4.66667,8.53333 C4.66667,7.50387 5.50387,6.66667 6.53333,6.66667 L7.46667,6.66667 C7.98187,6.66667 8.4,6.24807 8.4,5.73333 C8.4,5.2186 7.98187,4.8 7.46667,4.8 L6.53333,4.8 C4.4716,4.8 2.8,6.4716 2.8,8.53333 C2.8,10.59507 4.4716,12.2667 6.53333,12.2667 L10.2667,12.2667 C12.3284,12.2667 14,10.59507 14,8.53333 C14,7.14267 13.2375,5.93167 12.1095,5.28907 Z"})))},le=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 10 10",style:{width:"14px",height:"14px",display:"block",fill:"inherit",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M3,2 C2.44771525,2 2,1.55228475 2,1 C2,0.44771525 2.44771525,0 3,0 C3.55228475,0 4,0.44771525 4,1 C4,1.55228475 3.55228475,2 3,2 Z M3,6 C2.44771525,6 2,5.55228475 2,5 C2,4.44771525 2.44771525,4 3,4 C3.55228475,4 4,4.44771525 4,5 C4,5.55228475 3.55228475,6 3,6 Z M3,10 C2.44771525,10 2,9.55228475 2,9 C2,8.44771525 2.44771525,8 3,8 C3.55228475,8 4,8.44771525 4,9 C4,9.55228475 3.55228475,10 3,10 Z M7,2 C6.44771525,2 6,1.55228475 6,1 C6,0.44771525 6.44771525,0 7,0 C7.55228475,0 8,0.44771525 8,1 C8,1.55228475 7.55228475,2 7,2 Z M7,6 C6.44771525,6 6,5.55228475 6,5 C6,4.44771525 6.44771525,4 7,4 C7.55228475,4 8,4.44771525 8,5 C8,5.55228475 7.55228475,6 7,6 Z M7,10 C6.44771525,10 6,9.55228475 6,9 C6,8.44771525 6.44771525,8 7,8 C7.55228475,8 8,8.44771525 8,9 C8,9.55228475 7.55228475,10 7,10 Z"})))},ue=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 30 30",style:{width:"17px",height:"17px",display:"block",fill:"inherit",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M21,5c0-2.2-1.8-4-4-4h-4c-2.2,0-4,1.8-4,4H2v2h2v22h22V7h2V5H21z M13,3h4c1.104,0,2,0.897,2,2h-8C11,3.897,11.897,3,13,3zM24,27H6V7h18V27z M16,11h-2v12h2V11z M20,11h-2v12h2V11z M12,11h-2v12h2V11z"})))},se=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 16 16",style:{width:"15px",height:"15px",display:"block",fill:"rgba(55, 53, 47, 0.3)",flexShrink:0,backfaceVisibility:"hidden",marginRight:"9px",marginTop:"1px"}},r.a.createElement("path",{d:"M7.977 14.963c.407 0 .747-.324.747-.723V8.72h5.362c.399 0 .74-.34.74-.747a.746.746 0 00-.74-.738H8.724V1.706c0-.398-.34-.722-.747-.722a.732.732 0 00-.739.722v5.529h-5.37a.746.746 0 00-.74.738c0 .407.341.747.74.747h5.37v5.52c0 .399.332.723.739.723z"})))},pe=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 30 30",style:{width:"17px",height:"17px",display:"block",fill:"inherit",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M1,29h20V9H1V29z M3,11h16v16H3V11z M9,1v6h2V3h16v16h-4v2h6V1H9z"})))},de=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"15px",height:"15px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.237 1l7.84 1.237-1.201 7.61L11.5 6.15 9.424 9.38 6 8.84 7.237 1zM5.545 5.31a4 4 0 1 0 2.29 4.832l-2.979-.47.689-4.363zM7 15l4.5-7 4.5 7H7z"})))},me=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 30 30",style:{width:"19.8px",height:"19.8px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("g",null," ",r.a.createElement("path",{d:"M16,1H4v28h22V11L16,1z M16,3.828L23.172,11H16V3.828z M24,27H6V3h8v10h10V27z M8,17h14v-2H8V17z M8,21h14v-2H8V21z M8,25h14v-2H8V25z"})," "))," ")},fe=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 30 30",style:{width:"19.8px",height:"19.8px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("g",null," ",r.a.createElement("path",{d:"M16,1H4v28h22V11L16,1z M23.172,11H16V3.828L23.172,11z M24,27H6V3h8v10h10V27z"})," ")))},he=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"14px",height:"14px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("polygon",{points:"4.5 1 4.5 3 9.586 3 1 11.586 2.414 13 11 4.414 11 9.5 13 9.5 13 1"})))},be=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"14px",height:"14px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M4.46191,0 C3.8667,0 3.38428,0.482422 3.38428,1.07751 L3.38428,3.38425 L1.07764,3.38425 C0.482422,3.38425 0,3.86667 0,4.46179 C0,5.05688 0.482422,5.53931 1.07764,5.53931 L3.38428,5.53931 L3.38428,8.46063 L1.07764,8.46063 C0.482422,8.46063 0,8.94308 0,9.53818 C0,10.1333 0.482422,10.6157 1.07764,10.6157 L3.38428,10.6157 L3.38428,12.9224 C3.38428,13.5175 3.8667,13.9999 4.46191,13.9999 C5.05664,13.9999 5.53906,13.5175 5.53906,12.9224 L5.53906,10.6157 L8.46045,10.6157 L8.46045,12.9224 C8.46045,13.5175 8.94287,13.9999 9.53809,13.9999 C10.1333,13.9999 10.6157,13.5175 10.6157,12.9224 L10.6157,10.6157 L12.9224,10.6157 C13.5176,10.6157 14,10.1333 14,9.53818 C14,8.94308 13.5176,8.46063 12.9224,8.46063 L10.6157,8.46063 L10.6157,5.53931 L12.9224,5.53931 C13.5176,5.53931 14,5.05688 14,4.46179 C14,3.86667 13.5176,3.38425 12.9224,3.38425 L10.6157,3.38425 L10.6157,1.07751 C10.6157,0.482422 10.1333,0 9.53809,0 C8.94287,0 8.46045,0.482422 8.46045,1.07751 L8.46045,3.38425 L5.53906,3.38425 L5.53906,1.07751 C5.53906,0.482422 5.05664,0 4.46191,0 Z M5.53906,8.46063 L5.53906,5.53931 L8.46045,5.53931 L8.46045,8.46063 L5.53906,8.46063 Z"})))},ge=n(52),ve=n(81),ye=new(n(141).Logger)("notionapi-agent"),Ee=n(67),xe=n(99),ke=n(103),Oe=n(104),Ce=function(e){Object(xe.a)(n,e);var t=Object(ke.a)(n);function n(e){var a;return Object(ge.a)(this,n),(a=t.call(this)).name="RequestError",Object.setPrototypeOf(Object(Ee.a)(a),n.prototype),a.message=e,a}return n}(Object(Oe.a)(Error));function we(e){var t=new URL(e);if("http:"!==t.protocol&&"https:"!==t.protocol)throw new Ce("Unsupported protocol: ".concat(t.protocol));var n=t.port?t.port:"http:"===t.protocol?80:443,a={hostname:t.hostname,authority:t.hostname,port:n,path:t.pathname+t.search,method:"POST",headers:{}};return{setHeader:function(e,t){return a.headers[e]=t,this},sendAsJson:function(){var e=Object(d.a)(u.a.mark((function e(n){var r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ye.debug("http-util.ts: ".concat(a.method," ").concat(a.hostname," ").concat(a.port," ").concat(a.path)),this.setHeader("accept-encoding","gzip, deflate"),this.setHeader("content-type","application/json"),r="",e.prev=4,n&&(r=JSON.stringify(n)),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(4),e.t0;case 11:return e.prev=11,e.next=14,fetch(t.toString(),{method:"post",headers:a.headers,body:r});case 14:c=e.sent,e.next=20;break;case 17:throw e.prev=17,e.t1=e.catch(11),e.t1;case 20:return e.prev=20,e.next=23,c.json();case 23:return e.abrupt("return",e.sent);case 26:throw e.prev=26,e.t2=e.catch(20),e.t2;case 29:case"end":return e.stop()}}),e,this,[[4,8],[11,17],[20,26]])})));return function(t){return e.apply(this,arguments)}}()}}var je="https://www.notion.so",Le="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36",Se=function(e){Object(xe.a)(n,e);var t=Object(ke.a)(n);function n(e){var a;return Object(ge.a)(this,n),(a=t.call(this)).name="APIError",Object.setPrototypeOf(Object(Ee.a)(a),n.prototype),a.message='Server says "'.concat(e.name,": ").concat(e.message),e.status&&(a.message+=" Status: ".concat(e.status)),a.message+='"',a}return n}(Object(Oe.a)(Error));function Fe(e,t){return ye.debug('agent.ts: Create API function with URL "'.concat(e,'"')),function(){var n=Object(d.a)(u.a.mark((function n(a){var r;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return ye.debug('agent.ts: Call API "'.concat(e,'".')),n.next=3,we(e).setHeader("accept","*/*").setHeader("accept-language","en-US,en;q=0.9").setHeader("cookie","token_v2=".concat(t,";")).setHeader("origin",je).setHeader("referer",je).setHeader("user-agent",Le).sendAsJson(a);case 3:if(!(r=n.sent).hasOwnProperty("errorId")){n.next=7;break}throw new Se(r);case 7:return n.abrupt("return",r);case 8:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}var Ie=console.log,Te=n(61),_e=function(){function e(t){var n=this;Object(ge.a)(this,e),this.token=void 0,this.defaultHeaders={accept:"*/*","accept-language":"en-US,en;q=0.9","accept-encoding":"gzip, deflate, br",origin:"https://www.notion.so",referer:"https://www.notion.so"},this.custom={createWebClippedPage:function(){var e=Object(d.a)(u.a.mark((function e(t,a){var r,c,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.title,c=a.url,e.next=3,n.addWebClipperURLs({blockId:t,items:[{title:r,url:c}],from:"chrome",type:"block"});case 3:return o=e.sent,e.abrupt("return",o.createdBlockIds[0]);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},this.token=t}return Object(ve.a)(e,[{key:"_axios",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r,c,o=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"get",a=o.length>2&&void 0!==o[2]?o[2]:{},r=o.length>3&&void 0!==o[3]?o[3]:{},e.next=5,fetch("https://www.notion.so/api/v3/".concat(t.startsWith("/")&&t.slice(1)||t),{method:n.toUpperCase(),headers:Object(p.a)(Object(p.a)(Object(p.a)({"content-type":"application/json"},this.defaultHeaders),this.token&&{cookie:"token_v2=".concat(this.token)}),r),body:JSON.stringify(a)});case 5:return c=e.sent,e.abrupt("return",c.json());case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._axios(e,"post",t,n)}},{key:"put",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._axios(e,"put",t,n)}},{key:"delete",value:function(e){return this._axios(e,"delete")}},{key:"get",value:function(e){return this._axios(e,"get",null)}}]),Object(ve.a)(e,[{key:"addWebClipperURLs",value:function(e){return this.post("/addWebClipperURLs",e)}}]),e}(),Me=function(e){if(e){var t=e.replace(/\-/g,"").slice(-32);return"".concat((n=t).substr(0,8),"-").concat(n.substr(8,4),"-").concat(n.substr(12,4),"-").concat(n.substr(16,4),"-").concat(n.substr(20))}var n},Ve=function(e,t){switch(t.type){case"checkbox":if("boolean"!=typeof e)throw"value passed to property ".concat(t.strippedName," must be bool");return[[e?"Yes":"No"]];case"select":case"text":case"title":if("string"!=typeof e)throw"value passed to property ".concat(t.strippedName," must be string, but got ").concat(e);return[[e]];case"number":return[[String(parseFloat(e))]];case"multi_select":return[[e.join(",")]];case"relation":return e;default:return Ie("WARNING: ".concat(t.type," not uncasted")),[[e]]}};function Pe(e,t){var n=t.imgUrl,a=t.width,r=t.height,c=t.opts;Ie("here","ok","ok");var o=Te(),i=Te(),l={large:{width:672,height:380},normal:{width:672,height:250},small:{width:336,height:175}},u=l[c.size].width,p=l[c.size].height,d=null,m=null,f=!1,h=!1;switch(c.type){case"coverLike":"large"==c.size&&(h=!0),m=r,(d=a)!=u&&(m=Math.floor(m*(u/d)),d=u),m>p&&(d=Math.floor(d*(p/m)),m=p),d<u&&(h=!1),Ie("heve",m,d),m=null;break;case"fullWidthCover":f=!0,m=p}return[{id:o,table:"block",path:[],command:"set",args:{type:"text",id:o,version:1}},{id:o,table:"block",path:[],command:"update",args:{parent_id:e,parent_table:"block",alive:!0}},{table:"block",id:e,path:["content"],command:"listBefore",args:{id:o}},{id:o,table:"block",path:[],command:"update",args:{type:"image"}},{id:o,table:"block",path:["properties"],command:"update",args:{source:[[n]]}},{id:o,table:"block",path:["format"],command:"update",args:{display_source:n}},{id:o,table:"block",path:["format"],command:"update",args:{block_height:m,block_width:d,block_full_width:f,block_page_width:h}}].concat(Object(s.a)((1==c.addDivider||void 0===c.addDivider)&&[{id:i,table:"block",path:[],command:"set",args:{type:"divider",id:i,properties:{}}},{id:i,table:"block",path:[],command:"update",args:{parent_id:e,parent_table:"block",alive:!0}},{table:"block",id:e,path:["content"],command:"listAfter",args:{after:o,id:i}}]||[]))}var De={"youtube.com":!0},Ne=function(){function e(t,n,a,r){Object(ge.a)(this,e),this.id=void 0,this.parentId=void 0,this.viewId=void 0,this.fetched=void 0,this.schema=void 0,this.rows=void 0,this.client=void 0,this.id=t,this.parentId=a,this.fetched=!1,this.schema={},this.viewId=n,this.rows={},this.client=r}return Object(ve.a)(e,[{key:"initLocally",value:function(e){this._extractSchema(e),this.fetched=!0}},{key:"_extractSchema",value:function(e){this.schema={};for(var t=0,n=Object.keys(e);t<n.length;t++){var a=n[t],r=e[a];this.schema[a]=Object(p.a)(Object(p.a)({},r),{id:a,strippedName:""})}Ie("keys are ",Object.keys(this.schema))}},{key:"createRow",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){var a,r,c,o,i,l,s,p,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],r=null,!n){e.next=11;break}return c=new _e(this.client.authToken),console.log("got",t),e.next=7,c.custom.createWebClippedPage(this.parentId,{title:t.title,url:n.url});case 7:r=e.sent,console.log("got",r),e.next=14;break;case 11:o=this.client.createRecordOperations("block",{id:this.id,_table:"collection"},{type:"page"}),i=o.id,l=o.operations,r=i,a=l;case 14:if(this.rows[r]={id:r},s=!1,null!=n){s=!0;try{p=new URL(n.url),console.log("got",p.hostname),d=p.hostname.startsWith("www.")&&p.hostname.substring(4)||p.hostname,console.log(">>>>",d),d in De&&(s=!1)}catch(u){}}return e.abrupt("return",this.updateRow({where:{id:r},data:t,operations:a,skipFrontImage:s}));case 18:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"findRow",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r,c,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.where).id||!(n.id in this.rows)){e.next=3;break}return e.abrupt("return",this.rows[n.id]);case 3:a=Object.keys(n).length,e.t0=u.a.keys(this.rows);case 5:if((e.t1=e.t0()).done){e.next=23;break}r=e.t1.value,c=this.rows[r],o=0,e.t2=u.a.keys(n);case 10:if((e.t3=e.t2()).done){e.next=19;break}if(i=e.t3.value,c[i]!=n[i]){e.next=16;break}o++,e.next=17;break;case 16:return e.abrupt("break",19);case 17:e.next=10;break;case 19:if(o!=a){e.next=21;break}return e.abrupt("return",c);case 21:e.next=5;break;case 23:return e.abrupt("return",null);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateRow",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r,c,o,i,l,p,d,m,f,h,b,g;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.where,a=t.data,r=t.operations,c=t.skipFrontImage,o=[],i=r,e.next=5,this.findRow({where:n});case 5:if(l=e.sent){e.next=8;break}throw"can't update because row not found";case 8:if(p=l.id,!a.__template){e.next=19;break}return e.t0=i.push,e.t1=i,e.t2=s.a,e.next=15,nt(a.__template.blocksMap,a.__template.id,l.id);case 15:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4),Ie(i,"\x1b[43m -- lowOperations \x1b[0m");case 19:a.pageFrontImage&&0==c&&i.push.apply(i,Object(s.a)(Pe(l.id,a.pageFrontImage))),e.t5=u.a.keys(a);case 21:if((e.t6=e.t5()).done){e.next=37;break}if("__template"!=(d=e.t6.value)&&"pageFrontImage"!=d){e.next=25;break}return e.abrupt("continue",21);case 25:if("pageCover"!=d){e.next=28;break}return o.push({path:["format","page_cover"],value:a[d].imgUrl}),e.abrupt("continue",21);case 28:if("pageIcon"!=d){e.next=31;break}return o.push({path:["format","page_icon"],value:a[d].imgUrl}),e.abrupt("continue",21);case 31:m=this.schema[d],f=["properties",m.id],h=Ve(a[d],m),o.push({path:f,value:h}),e.next=21;break;case 37:return e.next=39,this.client.updateDataRecord(p,o,i);case 39:for(g in b=this.rows[p],a)b[g]=a[g];return e.abrupt("return",{id:b.id});case 42:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Re(e,t,n){return null!=e&&null!=e[t]&&e[t].length&&e[t][0].length&&e[t][0][0]||n}function ze(e,t){for(var n=[],a=e[t];null!=a;){var r,c;if(!a.value)break;if("page"==a.value.type)n.push({name:Re(a.value.properties,"title","Untitled"),icon:(null===(c=a.value.format)||void 0===c?void 0:c.page_icon)||null});a=e[(null===(r=a.value)||void 0===r?void 0:r.parent_id)||null]}return n.reverse(),n}var Ue={id:null,spaces:[],givenName:null},Be=function(){function e(t){Object(ge.a)(this,e),this.user=void 0,this.agent=void 0,this.authToken=void 0,this.agent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.token?e.token:"",n=e.server?e.server:je;e.debug&&ye.setLogLevel("debug"),ye.debug('agent.ts: Create API agent with server "'.concat(n,'" and token "').concat(t.substr(0,9),'..."'));var a=Fe("".concat(n,"/api/v3/getActivityLog"),t),r=Fe("".concat(n,"/api/v3/getAssetsJson"),t),c=Fe("".concat(n,"/api/v3/getRecordValues"),t),o=Fe("".concat(n,"/api/v3/getSnapshotsList"),t),i=Fe("".concat(n,"/api/v3/getUserSharedPages"),t),l=Fe("".concat(n,"/api/v3/loadPageChunk"),t),u=Fe("".concat(n,"/api/v3/loadUserContent"),t),s=Fe("".concat(n,"/api/v3/queryCollection"),t),p=Fe("".concat(n,"/api/v3/submitTransaction"),t),d=Fe("".concat(n,"/api/v3/search"),t);return{getActivityLog:a,getAssetsJson:r,getRecordValues:c,getSnapshotsList:o,getUserSharedPages:i,loadPageChunk:l,loadUserContent:u,queryCollection:s,submitTransaction:p,search:d}}({token:t,debug:!1}),this.authToken=t,this.user=Ue}return Object(ve.a)(e,[{key:"addValueToPropertyCollection",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n,a,r,c){var o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Object(p.a)({},t.schema),i={id:r,value:a,color:c},o[n]=Object(p.a)(Object(p.a)({},o[n]),{},{options:[].concat(Object(s.a)(o[n].options||[]),[i])}),e.next=5,this._submitTransaction([{id:t.id,table:"collection",path:[],command:"update",args:{schema:o}}]);case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r,c){return e.apply(this,arguments)}}()},{key:"setUserInfos",value:function(e){this.user=e}},{key:"fetchUserInfos",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,a,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.agent.loadUserContent({});case 2:for(r in t=e.sent,n=Object.keys(t.recordMap.notion_user),this.user.id=n[0],a=t.recordMap.notion_user[this.user.id],this.user.givenName=a.value.given_name,t.recordMap.space)c=t.recordMap.space[r],this.user.spaces.push({id:r,name:c.value.name});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createRecordOperations",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=Te(),r=Object(p.a)({id:a,version:1,alive:!0,created_by:this.user.id,created_time:Date.now(),last_edited_time:Date.now(),parent_id:t.id,parent_table:t._table},n);return{id:a,operations:[this._buildOperation({id:a,command:"set",args:r,table:e})]}}},{key:"createRecord",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){var a,r,c,o=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>2&&void 0!==o[2]?o[2]:{},r=a.id||Te(),c=Object(p.a)({id:r,version:1,alive:!0,created_by:this.user.id,created_time:Date.now(),last_edited_time:Date.now(),parent_id:n.id,parent_table:n._table},a),e.next=5,this._submitTransaction([this._buildOperation({id:r,command:"set",args:c,table:t})]);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateDataRecord",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n,a){var r=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._submitTransaction([].concat(Object(s.a)(a||[]),Object(s.a)(n.map((function(e){return r._buildOperation({id:t,command:"set",table:"block",path:e.path,args:e.value})})))));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"getCollectionLocally",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n,a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new Ne(t,"",n,this)).initLocally(a),e.abrupt("return",r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"_buildOperation",value:function(e){return{id:(e=Object(p.a)(Object(p.a)({},{table:"block",path:[],args:{},command:"set"}),e)).id,path:e.path,args:e.args,command:e.command,table:e.table}}},{key:"searchCollectionPages",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n,a){var r,c,o,l,s,p,d,m;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.agent.search({type:"BlocksInParent",query:t,spaceId:a,parentId:n,limit:20,filters:{isDeletedOnly:!1,excludeTemplates:!0,isNavigableOnly:!0,requireEditPermissions:!1,ancestors:[],createdBy:[],editedBy:[],lastEditedTime:{},createdTime:{}},sort:"Relevance",source:"relation_menu"});case 2:r=e.sent,c=[],o=Object(i.a)(r.results),e.prev=5,o.s();case 7:if((l=o.n()).done){e.next=16;break}if(p=l.value,(d=p.id)in r.recordMap.block){e.next=12;break}return e.abrupt("continue",14);case 12:m=r.recordMap.block[d].value,c.push({id:m.id,name:Re(m.properties,"title","Untitled"),icon:(null===(s=m.format)||void 0===s?void 0:s.page_icon)||null});case 14:e.next=7;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),o.e(e.t0);case 21:return e.prev=21,o.f(),e.finish(21);case 24:return e.abrupt("return",c);case 25:case"end":return e.stop()}}),e,this,[[5,18,21,24]])})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"searchCollections",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,a,r,c,o,i=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:"",n=i.length>1&&void 0!==i[1]?i[1]:this.user.spaces[0].id,e.next=4,this.agent.search({query:t,type:"CollectionsInSpace",spaceId:n,limit:20,sort:"Relevance",source:"link_to_collection_block",filters:{isDeletedOnly:!1,excludeTemplates:!0,isNavigableOnly:!1,requireEditPermissions:!0,ancestors:[],createdBy:[],editedBy:[],lastEditedTime:{},createdTime:{}}});case 4:for(c in a=e.sent,r=[],a.recordMap.collection)(o=a.recordMap.collection[c].value).parents=ze(a.recordMap.block,o.parent_id),r.push(o);return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_submitTransaction",value:function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.agent.submitTransaction({requestId:Te(),transactions:[{id:Te(),operations:t}]}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"appendBulletPointToPage",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Te(),t=Me(t),Ie("got",t),r=[{id:a,table:"block",path:[],command:"update",args:{type:"bulleted_list",id:a,parent_id:t,parent_table:"block",alive:!0,version:1,created_time:Date.now(),last_edited_time:Date.now(),properties:{title:[[n]]}}},{table:"block",id:t,path:["content"],command:"listAfter",args:{id:a}}],e.abrupt("return",this._submitTransaction(r));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();var Ze=n(61);function He(e){return We.apply(this,arguments)}function We(){return(We=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.get("form-"+t,null);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(e){return Ge.apply(this,arguments)}function Ge(){return(Ge=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te.set("popup-state",Object(p.a)(Object(p.a)({},t),{},{createdAt:Date.now(),lastUpdatedAt:Date.now()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qe(e){return Je.apply(this,arguments)}function Je(){return(Je=Object(d.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.get("popup-state",null);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",n);case 5:Ke(),a=Date.now(),e.t0=n.pos,e.next="fillForm"===e.t0?10:"settings"===e.t0?15:18;break;case 10:if(n.url==t){e.next=12;break}return e.abrupt("return",null);case 12:if(!(a-n.lastUpdatedAt>6e4)){e.next=14;break}return e.abrupt("return",null);case 14:return e.abrupt("return",n);case 15:if(!(a-n.lastUpdatedAt>6e4)){e.next=17;break}return e.abrupt("return",null);case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ke(){return Ye.apply(this,arguments)}function Ye(){return(Ye=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ae(null));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xe(){return(Xe=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.get(D,[]);case 2:n=e.sent,te.set(D,n.filter((function(e){return e.id!=t}))),te.set("form-"+t,null);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(e,t,n){return $e.apply(this,arguments)}function $e(){return($e=Object(d.a)(u.a.mark((function e(t,n,a){var r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.get(D,[]);case 2:if(r=e.sent,"new"!=n){e.next=7;break}return e.delegateYield(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=U(4);r.some((function(e){return e.id==n}));)n=U(4);return t.id=n,r.push({name:t.name,id:n}),e.next=6,te.set(D,r);case 6:return e.next=8,te.set("form-"+n,et(t));case 8:c={id:n,name:t.name};case 9:case"end":return e.stop()}}),e)}))(),"t0",5);case 5:e.next=13;break;case 7:return r=r.map((function(e){return e.id!=a?e:{name:t.name,id:a,favorite:!0===e.favorite}})),c={id:a,name:t.name},e.next=11,te.set(D,r);case 11:return e.next=13,te.set("form-"+a,et(t));case 13:return B("storage size: ",JSON.stringify(t).length),e.abrupt("return",c);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function et(e){return console.log("colection !!!",e.collection),Object(p.a)(Object(p.a)({},e),{},{collection:Object(p.a)({},e.collection),name:e.name.length&&e.name||"Untitled",daps:e.daps.filter((function(e){return null!=e.property}))})}function tt(e,t,n,a){var r=a||Ze(),c={id:r,table:"block",path:[],command:"update",args:{}},o=[c];if("none"==e.role)return{id:r,ops:[Object(p.a)(Object(p.a)({},c),{},{args:{type:"text",parent_id:t}})]};var i=e.value;if(c.args=Object(p.a)(Object(p.a)({},i),{},{id:r,parent_id:t,copied_from:i.id}),["is_template","created_time","last_edited_time"].forEach((function(e){delete c.args[e]})),i.content){var l=i.content.map((function(e){return tt(n[e],r,n)})),u=l.map((function(e){return e.id}));c.args.content=u,o.push.apply(o,Object(s.a)(l.flatMap((function(e){return e.ops}))))}return{id:r,ops:o}}function nt(e,t,n){return at.apply(this,arguments)}function at(){return(at=Object(d.a)(u.a.mark((function e(t,n,a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=tt(t[n],void 0,t,a),e.abrupt("return",r.ops);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var rt=["pageCover","pageFrontImage","pageIcon"];function ct(e,t){if(e.needToResetCollection)return{daps:t,collection:void 0};var n,a=[],r=Object(i.a)(t);try{var c=function(){var t=n.value,r=e.fieldsToModify.find((function(e){return e.key==t.key})),c=void 0;if(t.property&&(rt.some((function(e){return e==t.property.id}))?(B("reaplie",t.property),c=t.property):c=Object(p.a)(Object(p.a)({},e.collection.schema[t.property.id]),{},{id:t.property.id})),!r)return a.push(Object(p.a)(Object(p.a)({},t),{},{property:c})),"continue";switch(r.action){case"remove":return"continue";case"removeDefaultValue":a.push(Object(p.a)(Object(p.a)({},t),{},{property:c,options:{}}))}};for(r.s();!(n=r.n()).done;)c()}catch(o){r.e(o)}finally{r.f()}return{collection:e.collection,daps:a}}function ot(e,t){return it.apply(this,arguments)}function it(){return(it=Object(d.a)(u.a.mark((function e(t,n){var a,r,c,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.agent.loadPageChunk({pageId:n,limit:1,cursor:{stack:[[{id:n,table:"block",index:0}]]},chunkNumber:0,verticalColumns:!1});case 2:if(o=e.sent,i=o.recordMap.block[n]){e.next=6;break}return e.abrupt("return",null);case 6:return B(i,"\x1b[43m -- page \x1b[0m"),e.abrupt("return",{name:(null===(a=i.value)||void 0===a?void 0:a.properties.title[0][0])||"undefined",id:n,lastEditedTime:i.value.last_edited_time||Date.now(),icon:(null===(r=i.value)||void 0===r||null===(c=r.format)||void 0===c?void 0:c.page_icon)||null});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lt(e,t,n,a){return ut.apply(this,arguments)}function ut(){return(ut=Object(d.a)(u.a.mark((function e(t,n,a,r){var c,o,l,s,p,d,m,f,h;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={needToResetCollection:!1,fieldsToModify:[]},e.next=3,t.agent.loadPageChunk({pageId:n.parent_id,limit:1,cursor:{stack:[[{id:n.parent_id,table:"block",index:0}]]},chunkNumber:0,verticalColumns:!1});case 3:if(o=e.sent,n.id in o.recordMap.collection){e.next=7;break}return c.needToResetCollection=!0,e.abrupt("return",c);case 7:if(c.collection=o.recordMap.collection[n.id].value,l=c.collection,!r.getTemplatesInfo||!l.template_pages){e.next=13;break}return e.next=12,Promise.all(l.template_pages.map((function(e){return ot(t,e)})));case 12:l.templatesInfo=e.sent;case 13:if(!r.checkTemplateUpToDate){e.next=26;break}if((l.template_pages||[]).some((function(e){return r.checkTemplateUpToDate.id}))){e.next=19;break}c.needToRemoveTemplate=!0,e.next=26;break;case 19:return e.next=21,ot(t,r.checkTemplateUpToDate.id);case 21:s=e.sent,B(s.lastEditedTime>r.checkTemplateUpToDate.lastEditedTime,"checking template is up to date",r.checkTemplateUpToDate,s),s.lastEditedTime>r.checkTemplateUpToDate.lastEditedTime&&(c.needToRefreshTemplate=!0),c.collection.template=s;case 26:return p=c.collection.schema,e.next=29,t.getCollectionLocally(n.id,n.parent_id,p);case 29:d=e.sent,m=Object(i.a)(a),e.prev=31,h=function(){var e=f.value;if(e.property){if(rt.some((function(t){return t==e.property.id})))return"continue";if(e.property.id in d.schema){var t=d.schema[e.property.id];if(e.property.type!=t.type)c.fieldsToModify.push({key:e.key,action:"removeDefaultValue"});else if(["select","multi_select"].includes(e.property.type))switch(e.property.type){case"select":!e.options.defaultSelectId||t.options&&t.options.some((function(t){return t.id==e.options.defaultSelectId}))||c.fieldsToModify.push({key:e.key,action:"removeDefaultValue"});break;case"multi_select":!e.options.defaultSelectIds||t.options&&e.options.defaultSelectIds.every((function(e){return t.options.some((function(t){return t.id==e}))}))||c.fieldsToModify.push({key:e.key,action:"removeDefaultValue"})}}else c.fieldsToModify.push({key:e.key,action:"remove"})}},m.s();case 34:if((f=m.n()).done){e.next=40;break}if("continue"!==h()){e.next=38;break}return e.abrupt("continue",38);case 38:e.next=34;break;case 40:e.next=45;break;case 42:e.prev=42,e.t0=e.catch(31),m.e(e.t0);case 45:return e.prev=45,m.f(),e.finish(45);case 48:return e.abrupt("return",c);case 49:case"end":return e.stop()}}),e,null,[[31,42,45,48]])})))).apply(this,arguments)}function st(e){try{return window.btoa(e)}catch(t){return e}}function pt(e){try{return window.atob(e)}catch(t){return e}}function dt(e,t){return mt.apply(this,arguments)}function mt(){return(mt=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,B("fetch",t.user),e.next=4,t.fetchUserInfos();case 4:B("fetchdone",t.user),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{status:"error",errorMsg:"cookie_expired"});case 10:return e.next=12,te.set("notion-client-data",st(JSON.stringify(t.user)));case 12:return e.next=14,te.set("cookie",st(n));case 14:return e.abrupt("return",{status:"ok",client:t});case 15:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function ft(e){return ht.apply(this,arguments)}function ht(){return(ht=Object(d.a)(u.a.mark((function e(t){var n,a,r,c,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(chrome.cookies.get,{url:"https://www.notion.so",name:"token_v2"});case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return",{status:"error",errorMsg:"need_to_login_to_notion"});case 5:return r=a.value,e.next=8,te.get("cookie",null);case 8:return(c=e.sent)&&(c=pt(c)),e.next=12,te.get("notion-client-data",null);case 12:if((o=e.sent)&&(o=JSON.parse(pt(o))),n=new Be(r),c&&c==r&&o){e.next=22;break}return t&&t("fetching_client"),e.next=19,dt(n,r);case 19:return e.abrupt("return",e.sent);case 22:n.setUserInfos(o);case 23:return e.abrupt("return",{status:"ok",client:n});case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var bt={},gt={};function vt(e){return yt.apply(this,arguments)}function yt(){return(yt=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in bt)){e.next=2;break}return e.abrupt("return",bt[t].map);case 2:return e.next=4,te.get("collection-pages-".concat(t),{count:0,map:{},order:[]});case 4:return n=e.sent,bt[t]=n,e.abrupt("return",n.map);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Et(e,t){return xt.apply(this,arguments)}function xt(){return(xt=Object(d.a)(u.a.mark((function e(t,n){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vt(n);case 2:return a=e.sent,t.id in a||(bt[n].count>300&&(r=bt[n].order.shift(),delete a[r],bt[n].count--),bt[n].count++,bt[n].order.push(t.id)),a[t.id]=t,gt[n]||(gt[n]=setTimeout(Object(d.a)(u.a.mark((function e(){var t,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=bt[n].map,a=Object.keys(t).sort((function(e,n){return t[e].name.toLowerCase()<t[n].name.toLowerCase()?-1:1})),r={},a.forEach((function(e){return r[e]=bt[n].map[e]})),e.next=6,te.set("collection-pages-".concat(n),Object(p.a)(Object(p.a)({},bt[n]),{},{map:r}));case 6:gt[n]=null;case 7:case"end":return e.stop()}}),e)}))),200)),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var kt,Ot=[];function Ct(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ot.push({component:e,props:t}),kt&&kt()}function wt(){Ot.length&&Ot.pop(),kt&&kt()}var jt={component:function(e){return e.children},props:{}};function Lt(e){var t=e.children,n=function(){var e=a.useState(Object.create(null)),t=Object(m.a)(e,2)[1];return a.useCallback((function(){t(Object.create(null))}),[t])}();a.useEffect((function(){kt=n}),[n]);var r=Ot[Ot.length-1]||jt,c=r.component,o=r.props;return a.createElement(c,o,t)}var St=n(44),Ft=function(e,t,n){return function(e,t,n){var a=n<0?e.length+n:n,r=e.splice(t,1)[0];e.splice(a,0,r)}(e=e.slice(),t,n),e},It=n(107).default,Tt=n(176).default,_t={select:r.a.createElement(ne,null),multi_select:r.a.createElement(re,null),checkbox:r.a.createElement(ae,null),text:r.a.createElement(ce,null),url:r.a.createElement(ie,null),title:r.a.createElement(oe,null),relation:r.a.createElement(he,null),number:r.a.createElement(be,null),image:r.a.createElement(It,{style:{fontSize:"16px",color:"rgba(55, 53, 47, 0.4)",paddingTop:"3px"}}),template:r.a.createElement(de,null),saveContent:r.a.createElement(Tt,{style:{fontSize:"18px",color:"rgba(55, 53, 47, 0.4)",paddingTop:"3px"}})},Mt=function(e){var t=e.option;return r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement("div",{style:{width:25}},t.type in _t&&r.a.createElement("div",{style:{marginRight:"4px"}},_t[t.type])," "),r.a.createElement("div",{style:{marginLeft:"4px",fontSize:"14px"}},t.name))},Vt=n(83).default,Pt=n(76).default,Dt=(n(178).default,function(e,t,n){return"".concat(function(e){return"https://notion.so/image/".concat(encodeURIComponent(e.startsWith("/image")?"https://notion.so".concat(e):e))}(e),"?table=collection&id=").concat(t,"&userId=").concat(n,"&cache=v2")}),Nt=function(e){var t=e.icon,n=e.collectionId,a=e.userId;return t?r.a.createElement("div",{style:{marginRight:"4px",display:"flex",alignItems:"center"}},t.startsWith("http")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:Dt(t,n,a),height:"20px",width:"20px"})):r.a.createElement(r.a.Fragment,null,t)):r.a.createElement("div",{style:{width:"27px"}},r.a.createElement(me,null))},Rt=function(e){var t=e.parents;return r.a.createElement("div",{style:{color:"grey",fontSize:11,fontWeight:350}},t.length>=1&&r.a.createElement(r.a.Fragment,null,t[0].name),t.length>=3?" / ... / ":2==t.length?" / ":"",t.length>=2&&r.a.createElement(r.a.Fragment,null,t[t.length-1].name))},zt=function(e){var t=e.collection,n=e.onSelectCollection,c=e.spaceId,o=(e.daps,e.disabled),i=r.a.useState(!1),l=Object(m.a)(i,2),f=l[0],h=l[1],b=Object(a.useState)(!1),g=Object(m.a)(b,2),v=g[0],y=g[1],E=Object(a.useState)(!1),k=Object(m.a)(E,2),O=k[0],C=k[1],w=Object(a.useState)({count:0,collections:{}}),L=Object(m.a)(w,2),S=(L[0],L[1],r.a.useState(Object(s.a)(t?[t]:[]))),F=Object(m.a)(S,2),I=F[0],T=F[1],V=Object(a.useState)(""),P=Object(m.a)(V,2),D=P[0],N=P[1],R=f&&v,z=Object(a.useContext)(Qa).client,U=function(e){var t={},n=Object(s.a)(e);e.forEach((function(e){t[e.id]=!0}));for(var a=0;a<I.length&&a<70;a++)I[a].id in t||n.push(I[a]);T(n)},B=Object(a.useMemo)((function(){return H(function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.searchCollections(t,c);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),500)}),[c]);return Object(a.useEffect)((function(){t&&N(t.name[0][0])}),[t]),Object(a.useEffect)((function(){C(!1),y(!0),Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(D);case 2:(t=e.sent)&&(U(t),y(!1));case 4:case"end":return e.stop()}}),e)})))()}),[D,O]),r.a.createElement(r.a.Fragment,null,r.a.createElement(_,{align:"center",flex:1},r.a.createElement(j,{style:{minWidth:"200px",marginRight:"28px",fontSize:"1rem",fontWeight:400}},r.a.createElement(Mt,{option:{name:"Database",type:"database"}})),r.a.createElement(_,{flex:1},r.a.createElement(Vt,{size:"small",disabled:o,style:{width:220},inputValue:D,onInputChange:function(e,t){return N(t)},value:t,open:f,onOpen:function(){h(!0)},loading:R,openOnFocus:!0,onFocus:function(){C(!0)},onClose:function(){h(!1)},onChange:function(e,t,a){console.log("select database",t,a),n&&n(t)},getOptionSelected:function(e,t){return e.name[0][0]===t.name[0][0]},renderOption:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement(Nt,{icon:e.icon,collectionId:e.id,userId:z.user.id}),r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",null,e.name[0][0]),r.a.createElement(Rt,{parents:e.parents||[]}))))},getOptionLabel:function(e){return e.name[0][0]},options:I,renderInput:function(e){return r.a.createElement(x,Object.assign({},e,{style:{width:"200px"},className:"collectionField",placeholder:"Select Database...",InputProps:Object(p.a)(Object(p.a)({},e.InputProps),{},{endAdornment:r.a.createElement(r.a.Fragment,null,R?r.a.createElement(Pt,{color:"inherit",size:20}):null,e.InputProps.endAdornment)})}))}}))),r.a.createElement(_,{align:"center"},r.a.createElement(M,{width:"300px"})))},Ut=n(143),Bt=n.n(Ut),Zt=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"14px",height:"14px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M7,13 C10.31348,13 13,10.31371 13,7 C13,3.68629 10.31348,1 7,1 C3.68652,1 1,3.68629 1,7 C1,10.31371 3.68652,13 7,13 Z M3.75098,5.32278 C3.64893,5.19142 3.74268,5 3.90869,5 L10.09131,5 C10.25732,5 10.35107,5.19142 10.24902,5.32278 L7.15771,9.29703 C7.07764,9.39998 6.92236,9.39998 6.84229,9.29703 L3.75098,5.32278 Z"})))},Ht=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"14px",height:"14px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M4,3 C4,2.447715 4.447715,2 5,2 L12,2 C12.5523,2 13,2.447716 13,3 C13,3.55228 12.5523,4 12,4 L5,4 C4.447715,4 4,3.55228 4,3 Z M4,7 C4,6.447715 4.447715,6 5,6 L12,6 C12.5523,6 13,6.447716 13,7 C13,7.55228 12.5523,8 12,8 L5,8 C4.447715,8 4,7.55228 4,7 Z M4,11 C4,10.447715 4.447715,10 5,10 L12,10 C12.5523,10 13,10.447716 13,11 C13,11.55228 12.5523,12 12,12 L5,12 C4.447715,12 4,11.55228 4,11 Z M2,4 C1.44771525,4 1,3.55228475 1,3 C1,2.44771525 1.44771525,2 2,2 C2.55228475,2 3,2.44771525 3,3 C3,3.55228475 2.55228475,4 2,4 Z M2,8 C1.44771525,8 1,7.55228475 1,7 C1,6.44771525 1.44771525,6 2,6 C2.55228475,6 3,6.44771525 3,7 C3,7.55228475 2.55228475,8 2,8 Z M2,12 C1.44771525,12 1,11.5522847 1,11 C1,10.4477153 1.44771525,10 2,10 C2.55228475,10 3,10.4477153 3,11 C3,11.5522847 2.55228475,12 2,12 Z"})))},Wt=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"14px",height:"14px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"})))},At=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"14px",height:"14px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"})))},Gt=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"16px",height:"16px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M0,3 C0,1.34314 1.34326,0 3,0 L11,0 C12.6567,0 14,1.34314 14,3 L14,11 C14,12.6569 12.6567,14 11,14 L3,14 C1.34326,14 0,12.6569 0,11 L0,3 Z M3,1.5 C2.17139,1.5 1.5,2.17157 1.5,3 L1.5,11 C1.5,11.8284 2.17139,12.5 3,12.5 L11,12.5 C11.8286,12.5 12.5,11.8284 12.5,11 L12.5,3 C12.5,2.17157 11.8286,1.5 11,1.5 L3,1.5 Z M2.83252,6.8161 L3.39893,6.27399 L3.57617,6.10425 L3.92334,5.77216 L4.26904,6.10559 L4.44531,6.27582 L5.58398,7.37402 L9.28271,3.81073 L9.45996,3.64008 L9.80664,3.3056 L10.1538,3.63989 L10.3311,3.81067 L10.8936,4.35303 L11.0708,4.52399 L11.4434,4.88379 L11.0708,5.24353 L10.8936,5.41437 L6.1084,10.0291 L5.93115,10.2 L5.58398,10.5344 L5.23682,10.2 L5.05957,10.0292 L2.83057,7.87946 L2.65283,7.70801 L2.27832,7.34674 L2.6543,6.98694 L2.83252,6.8161 Z"})))},qt=function(e){return Object(f.a)(e),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{viewBox:"0 0 14 14",style:{width:"14px",height:"14px",display:"block",fill:"rgba(55, 53, 47, 0.4)",flexShrink:0,backfaceVisibility:"hidden"}},r.a.createElement("path",{d:"M3.73333,3.86667 L7.46667,3.86667 C8.49613,3.86667 9.33333,4.70387 9.33333,5.73333 C9.33333,6.7628 8.49613,7.6 7.46667,7.6 L6.53333,7.6 C6.01813,7.6 5.6,8.0186 5.6,8.53333 C5.6,9.04807 6.01813,9.46667 6.53333,9.46667 L7.46667,9.46667 C9.5284,9.46667 11.2,7.79507 11.2,5.73333 C11.2,3.6716 9.5284,2 7.46667,2 L3.73333,2 C1.6716,2 0,3.6716 0,5.73333 C0,7.124 0.762067,8.33453 1.88953,8.97713 C1.87553,8.83107 1.86667,8.6836 1.86667,8.53333 C1.86667,7.92013 1.98753,7.33447 2.2036,6.7978 C1.99267,6.4954 1.86667,6.12953 1.86667,5.73333 C1.86667,4.70387 2.70387,3.86667 3.73333,3.86667 Z M12.1095,5.28907 C12.1231,5.4356 12.1333,5.58307 12.1333,5.73333 C12.1333,6.34607 12.0101,6.9294 11.7931,7.46513 C12.0059,7.768 12.1333,8.13573 12.1333,8.53333 C12.1333,9.5628 11.2961,10.4 10.2667,10.4 L6.53333,10.4 C5.50387,10.4 4.66667,9.5628 4.66667,8.53333 C4.66667,7.50387 5.50387,6.66667 6.53333,6.66667 L7.46667,6.66667 C7.98187,6.66667 8.4,6.24807 8.4,5.73333 C8.4,5.2186 7.98187,4.8 7.46667,4.8 L6.53333,4.8 C4.4716,4.8 2.8,6.4716 2.8,8.53333 C2.8,10.59507 4.4716,12.2667 6.53333,12.2667 L10.2667,12.2667 C12.3284,12.2667 14,10.59507 14,8.53333 C14,7.14267 13.2375,5.93167 12.1095,5.28907 Z"})))},Jt=n(73).default,Kt=(n(72).default,n(84).default),Yt=n(179).default,Xt=n(138).default,Qt=n(136).default,$t=n(107).default,en=(n(56).default,{select:r.a.createElement(Zt,null),multi_select:r.a.createElement(Ht,null),text:r.a.createElement(Wt,null),url:r.a.createElement(qt,null),checkbox:r.a.createElement(Gt,null),title:r.a.createElement(At,null),image:r.a.createElement($t,{style:{fontSize:"14px",color:"rgba(55, 53, 47, 0.4)"}}),relation:r.a.createElement(he,null),number:r.a.createElement(be,null)}),tn=n(83).default,nn=n(83).createFilterOptions,an=(n(129).default,n(82).default),rn=(n(74).default,nn({limit:20,trim:!0})),cn=function(e){var t=e.defaultValue,n=e.onChangeValue,c=(e.refresh,e.name),o=e.textClass,i=e.textStyle,l=(e.isNumber,Object(a.useState)(t)),u=Object(m.a)(l,2),s=u[0],p=u[1],d=r.a.useRef(null);return Object(a.useEffect)((function(){p(t)}),[t]),r.a.createElement(x,{className:o||void 0,style:i||{},value:s,multiline:!0,rowsMax:3,onChange:function(e){p(e.target.value),d.current||(d.current=setTimeout((function(){p((function(e){return n(e),d.current=null,e}))}),700))},placeholder:"".concat(c,"..."),onBlur:function(){B("got blurred",s),n(s)}})},on=function(e){var t=e.data;return r.a.createElement(M,null,r.a.createElement(j,null),r.a.createElement(M,null,r.a.createElement(_,{align:"center"},r.a.createElement(Yt,{style:{color:"rgba(55, 53, 47, 0.4)",fontSize:"18px",marginRight:"8px"}}),r.a.createElement("div",{className:"titleDataOptionRow",style:{}},t.name)),t.example&&t.example.length&&r.a.createElement("div",{className:"descriptionDataOptionRow"},"example: ",t.example)))},ln=function(e){var t=e.data;return r.a.createElement(_,{align:"center"},r.a.createElement(Yt,{style:{color:"rgba(55, 53, 47, 0.4)",fontSize:"18px",marginRight:"8px"}}),r.a.createElement("div",{className:"selectedDataOptionRow"},t.name))},un=function(e){var t=e.datas,n=(e.name,e.textClass),c=e.options,o=e.onSetOptions,i=e.textStyle,l=Object(a.useState)(c.selectedData?[t.find((function(e){return e.key==c.selectedData}))]:[]),s=Object(m.a)(l,2),p=s[0],f=s[1],h=Object(a.useState)(c.defaultValue||""),g=Object(m.a)(h,2),v=g[0],y=g[1];return Object(a.useEffect)((function(){c.defaultValue?y(c.defaultValue):y("")}),[c]),r.a.createElement(r.a.Fragment,null,r.a.createElement(tn,{multiple:!0,freeSolo:!0,size:"small",includeInputInList:!0,inputValue:v,onInputChange:function(e,t,n){return y(t)},blurOnSelect:!0,value:p,options:t||[],getOptionLabel:function(e){return e.name},renderOption:function(e){return r.a.createElement(on,{data:e})},renderTags:function(e,t){return e.map((function(e,n){if(console.log(">>>>",e),"string"==typeof e)return e;var a=t({index:n});a.key,Object(b.a)(a,["key"]);return r.a.createElement(ln,{data:e})}))},filterOptions:function(e,t){return rn(e,t)},style:{},onChange:function(){var e=Object(d.a)(u.a.mark((function e(t,n,a){var r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n,"blur"==a&&B("BLUR"),B("SUBMIT",r,a,"\x1b[43m -- opts \x1b[0m"),0!=r.length){e.next=7;break}return o({defaultValue:""}),f([]),e.abrupt("return");case 7:"string"==typeof(c=r[0])?(B("save here",c),o({defaultValue:c})):(o({selectedData:c.key}),f([c]));case 9:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),renderInput:function(e){return r.a.createElement(x,Object.assign({onMouseDown:e.inputProps.onMouseDown,className:n||void 0,placeholder:0==p.length?"Empty":"",style:i||{}},e,{variant:"outlined"}))}}))},sn=function(e){var t=e.defaultValue,n=e.onChangeValue,c=(e.refresh,e.propertyName),o=Object(a.useState)(t),i=Object(m.a)(o,2),l=i[0],u=i[1];return Object(a.useEffect)((function(){u(t)}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Xt,{style:{userSelect:"none"},className:"checkBoxField",control:r.a.createElement(Qt,{checked:l,onChange:function(e){u(e.target.checked),n(e.target.checked)},name:c,color:"primary"}),label:c}))},pn=function(e){var t=e.name,n=e.value,a=e.onChange,c=e.checkboxClass,o=e.checkboxStyle,i=e.size,l=void 0===i?"medium":i;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Xt,{className:"".concat(c||""," checkBox-").concat(l),style:o||{},control:r.a.createElement(Qt,{size:l,checked:n,onChange:function(e){a(e.target.checked)},name:t,color:"primary"}),label:t}))};function dn(e){if(e.options.defaultSelectId&&e.property.options)return e.property.options.find((function(t){return t.id==e.options.defaultSelectId}))}var mn=function(e){var t=e.value,n=e.options,a=e.onSelectOption,c=e.renderOption,o=e.uniqueKey,i=e.style,l=e.className,u=e.renderValue,s=e.disabled,p=e.onOpen,d=e.displayEmpty,m=e.renderOptionEmpty,f=e.renderValueEmpty;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Jt,{disabled:s,style:i,className:l,value:t,onOpen:p,onChange:function(e){a(e.target.value)},renderValue:function(e){return f&&""==e?f():u(e)},displayEmpty:d},m&&r.a.createElement(Kt,{value:""},m()),n.map((function(e){return r.a.createElement(Kt,{key:e[o],value:e[o]},c(e))}))))},fn=function(e){var t=e.dap,n=e.onChangeField,c=(e.refresh,e.textClass),o=e.textStyle,i=e.size,l=Object(a.useState)(dn(t)),f=Object(m.a)(l,1)[0],h=Object(a.useState)(f?[f]:[]),g=Object(m.a)(h,2),v=g[0],y=g[1],E=Object(a.useContext)(Ba),k=E.createNewValueForProperty;E.refreshCollection;return Object(a.useEffect)((function(){var e=dn(t);B("here change!",e),y(e?[e]:[])}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(tn,{multiple:!0,openOnFocus:!0,value:v,options:t.property.options||[],getOptionLabel:function(e){return e.value},size:i,blurOnSelect:!0,renderOption:function(e){return"create"==e.type?r.a.createElement("div",null,r.a.createElement("span",{style:{marginRight:"2px"}},"Create"),r.a.createElement(an,{label:e.value,style:{backgroundColor:W(e)}})):r.a.createElement(an,{label:e.value,style:{backgroundColor:W(e)}})},renderTags:function(e,t){return e.map((function(e,n){var a=t({index:n}),c=a.key,o=Object(b.a)(a,["key"]);return r.a.createElement(an,{key:c,"data-tag-index":o["data-tag-index"],label:e.value,style:{backgroundColor:W(e)}})}))},filterOptions:function(e,t){var n=rn(e,t);return""===t.inputValue||1==n.length&&n[0].value==t.inputValue||n.push({type:"create",value:bn(t.inputValue),color:R()}),n},style:{},onChange:function(){var e=Object(d.a)(u.a.mark((function e(a,r,c){var o,i,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("render property",r,c),B(t,r,"\x1b[43m -- dap \x1b[0m"),o=null,i=r.map((function(e){return"create"==e.type?o=k(t.property.id,e.value,e.color):e})),B(i,"\x1b[43m -- opts \x1b[0m"),0==i.length?(l="",y([])):(l=i[i.length-1].id,y([i[i.length-1]])),n(Object(p.a)(Object(p.a)({},t),{},{options:{defaultSelectId:l},property:Object(p.a)(Object(p.a)({},t.property),{},{options:[].concat(Object(s.a)(t.property.options||[]),Object(s.a)(o?[o]:[]))})}));case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),renderInput:function(e){return r.a.createElement(x,Object.assign({onMouseDown:function(t){var n,a;if(!(null===(n=t.target)||void 0===n||null===(a=n.classList)||void 0===a?void 0:a.contains("MuiSvgIcon-root")))return e.inputProps.onMouseDown(t)},placeholder:0==v.length?"Empty":"",className:c||void 0,style:o||{}},e,{variant:"outlined"}))}}))};function hn(e){if(!e.options.defaultSelectIds||!e.property.options)return[];var t={};return e.options.defaultSelectIds.forEach((function(e){return t[e]=!0})),e.property.options.filter((function(e){return t[e.id]}))}function bn(e){return e.replace(/,/g," ")}var gn=function(e){var t=e.dap,n=e.onChangeField,c=e.refresh,o=e.textClass,i=e.textStyle,l=e.size,u=(r.a.useRef(null),Object(a.useState)(hn(t))),d=Object(m.a)(u,2),f=d[0],h=d[1],g=Object(a.useContext)(Ba),v=g.createNewValueForProperty,y=(g.refreshCollection,Object(a.useState)(!1)),E=Object(m.a)(y,2);E[0],E[1];return Object(a.useEffect)((function(){var e=hn(t);B("optimistic, rerender here",c,t,f,e),h(e)}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(tn,{multiple:!0,value:f,size:l,openOnFocus:!0,disableCloseOnSelect:!0,options:t.property.options||[],getOptionLabel:function(e){return e.value},style:{},renderOption:function(e){return"create"==e.type?r.a.createElement("div",null,r.a.createElement("span",{style:{marginRight:"2px"}},"Create"),r.a.createElement(an,{label:e.value,style:{backgroundColor:W(e)}})):r.a.createElement(an,{label:e.value,style:{backgroundColor:W(e)}})},onChange:function(e,a,r){var c=null,o=a.map((function(e){return"create"==e.type?c=v(t.property.id,e.value,e.color):e}));h(o),n(Object(p.a)(Object(p.a)({},t),{},{options:{defaultSelectIds:o.map((function(e){return e.id}))},property:Object(p.a)(Object(p.a)({},t.property),{},{options:[].concat(Object(s.a)(t.property.options||[]),Object(s.a)(c?[c]:[]))})}))},filterOptions:function(e,t){var n=rn(e,t);return""===t.inputValue||1==n.length&&n[0].value==t.inputValue||n.push({type:"create",value:bn(t.inputValue),color:R()}),n},limitTags:3,renderTags:function(e,t){return e.map((function(e,n){var a=t({index:n}),c=a.key,o=Object(b.a)(a,["key"]);return r.a.createElement(an,{key:c,"data-tag-index":o["data-tag-index"],label:e.value,style:{backgroundColor:W(e),marginLeft:"2px",marginTop:"2px"}})}))},renderInput:function(e){return r.a.createElement(x,Object.assign({onMouseDown:function(t){var n;if(!Object(s.a)((null===(n=t.target)||void 0===n?void 0:n.classList)||[]).includes("MuiSvgIcon-root"))return e.inputProps.onMouseDown(t)},placeholder:0==f.length?"Empty":"",className:o||void 0,style:i||{}},e,{variant:"outlined"}))}}))};function vn(e,t){if(!e.options.defaultSelectIds)return[];var n=[];return e.options.defaultSelectIds.forEach((function(e){n.push(t[e])})),n}var yn=function(e,t,n){return"".concat(function(e){return"https://notion.so/image/".concat(encodeURIComponent(e.startsWith("/image")?"https://notion.so".concat(e):e))}(e),"?table=block&id=").concat(t,"&userId=").concat(n,"&cache=v2")},En=function(e){var t=e.icon,n=e.pageId,a=e.userId;return t?r.a.createElement("div",{style:{marginRight:"4px",display:"flex",alignItems:"center"}},t.startsWith("http")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:yn(t,n,a),height:"20px",width:"20px"})):r.a.createElement(r.a.Fragment,null,t)):r.a.createElement("div",{style:{width:"27px"}},r.a.createElement(me,null))},xn=function(e){var t=e.name,n=e.icon,a=e.iconComp,c=e.userId,o=e.pageId,i=e.className;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},a&&a||r.a.createElement(En,{icon:n,pageId:o,userId:c}),r.a.createElement("div",{className:i||"notionPage"},t)))},kn=function(e){var t=e.dap,n=e.onChangeOptions,c=e.textClass,o=e.textStyle,i=e.size,l=r.a.useState(!1),p=Object(m.a)(l,2),f=p[0],h=p[1],g=Object(a.useState)(!1),v=Object(m.a)(g,2),y=v[0],E=v[1],k=Object(a.useContext)(Ba),O=k.createNewPageInCollection,C=k.upsertCachedCollectionPage,w=k.getCachedCollectionPages,j=k.spaceId,L=Object(a.useState)([]),S=Object(m.a)(L,2),F=S[0],I=S[1],T=Object(a.useState)(!1),_=Object(m.a)(T,2),M=_[0],V=_[1],P=Object(a.useState)(!0),D=Object(m.a)(P,2),N=D[0],R=D[1],z=r.a.useState([]),U=Object(m.a)(z,2),Z=U[0],W=U[1],A=Object(a.useState)(""),G=Object(m.a)(A,2),q=G[0],J=G[1],K=f&&y,Y=Object(a.useContext)(Qa).client,X=function(){var e=Object(d.a)(u.a.mark((function e(n){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t.property.collection_id);case 2:a=e.sent,r=[],Object.keys(a).forEach((function(e){r.push(a[e])})),n.forEach((function(e){e.id in a||r.push(e),C(e,t.property.collection_id)})),B("got1",n),B("got",r),W(r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=Object(a.useMemo)((function(){return H(function(){var e=Object(d.a)(u.a.mark((function e(n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.searchCollectionPages(n,t.property.collection_id,j);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),500)}),[]);return Object(a.useEffect)((function(){V(!1),E(!0),Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q(q);case 2:t=e.sent,B("received2",t),t&&(X(t),E(!1));case 5:case"end":return e.stop()}}),e)})))()}),[q,M]),Object(a.useEffect)((function(){Object(d.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B("uo HAVE",t),e.t0=vn,e.t1=t,e.next=5,w(t.property.collection_id);case 5:e.t2=e.sent,n=(0,e.t0)(e.t1,e.t2),B("uo DEFAULT",n),I(n);case 9:case"end":return e.stop()}}),e)})))()}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(tn,{multiple:!0,value:F,size:i,open:f,onOpen:function(){1==N&&(R(!1),Object(d.a)(u.a.mark((function e(){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B("FIRST OPEN"),e.next=3,w(t.property.collection_id);case 3:n=e.sent,B("REEV",n),a=Object.keys(n).map((function(e){return n[e]})),B("OPTO",a),W(a);case 8:case"end":return e.stop()}}),e)})))()),h(!0)},inputValue:q,onInputChange:function(e,t){return J(t)},openOnFocus:!0,onFocus:function(){V(!0)},onClose:function(){h(!1)},loading:K,disableCloseOnSelect:!0,options:Z||[],getOptionLabel:function(e){return e.name},style:{},renderOption:function(e){return"create"==e.type?r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",null,r.a.createElement("span",{style:{marginRight:"8px"}},"Create")),r.a.createElement(xn,{userId:Y.user.id,pageId:e.id,icon:e.icon,name:e.name})):r.a.createElement(xn,{userId:Y.user.id,pageId:e.id,icon:e.icon,name:e.name})},onChange:function(e,a,r){var c=null,o=a.map((function(e){return"create"==e.type?(c=O(e.name,t.property.collection_id),B("NEW OPT",c),c):e}));B("uo UPDAED",o),I(o),n({defaultSelectIds:o.map((function(e){return e.id}))})},filterOptions:function(e,t){var n=rn(e,t);return""===t.inputValue||1==n.length&&n[0].name.toLowerCase()==t.inputValue.toLowerCase()||n.push({type:"create",name:t.inputValue}),n},limitTags:3,renderTags:function(e,t){return e.map((function(e,n){var a=t({index:n}),c=a.key,o=Object(b.a)(a,["key"]);return r.a.createElement("div",{"data-tag-index":o["data-tag-index"],style:{marginRight:"8px"},key:c},e&&r.a.createElement(xn,{userId:Y.user.id,pageId:e.id,icon:e.icon,name:e.name}))}))},renderInput:function(e){return r.a.createElement(x,Object.assign({onMouseDown:function(t){var n;if(!Object(s.a)((null===(n=t.target)||void 0===n?void 0:n.classList)||[]).includes("MuiSvgIcon-root"))return e.inputProps.onMouseDown(t)},placeholder:0==F.length?"Empty":"",className:c||void 0,style:o||{}},e,{variant:"outlined"}))}}))},On=function(e){var t=e.label,n=e.propertyType,a=e.children,c=Object(b.a)(e,["label","propertyType","children"]);return r.a.createElement(j,c,r.a.createElement(M,{mb:0},r.a.createElement(_,null,r.a.createElement(_,{mb:.1},r.a.createElement(j,{mr:.5},n in en?en[n]:null),r.a.createElement(T,{mb:.1,style:{textTransform:"capitalize"}}," ",t))),r.a.createElement(M,{width:"100%"},a)))},Cn=function(e){var t,n=e.dap,c=Object(a.useMemo)((function(){return dn(n)}),[n]),o=Object(a.useMemo)((function(){return hn(n)}),[n]);return"boolean"==typeof n.options.defaultValue?r.a.createElement(r.a.Fragment,null,n.options.defaultValue?"true":"false"):n.options.defaultValue?r.a.createElement(T,{style:{fontStyle:"italic"}},"url"==(null===(t=n.property)||void 0===t?void 0:t.type)&&n.options.defaultValue.replace(/(^\w+:|^)\/\/(?:www.)?/,"")||n.options.defaultValue):n.options.defaultSelectId?r.a.createElement(r.a.Fragment,null,r.a.createElement(an,{label:c.value,style:{backgroundColor:W(c),fontSize:"11px",color:"rgba(0, 0, 0, 0.54)"}})):n.options.defaultSelectIds?r.a.createElement("div",{style:{overflow:"hidden"}},o.map((function(e){return r.a.createElement(an,{key:e.id,label:e.value,style:{marginRight:"4px",marginTop:"2px",backgroundColor:W(e),fontSize:"11px",color:"rgba(0, 0, 0, 0.54)"}})}))):r.a.createElement(T,{color:"#9e9e9e"},"(empty)")},wn=function(e){var t=e.label,n=e.propertyType,a=e.children,c=Object(b.a)(e,["label","propertyType","children"]);return r.a.createElement(_,Object.assign({color:"text.secondary",align:"center"},c),r.a.createElement(On,{label:t,propertyType:n},r.a.createElement(r.a.Fragment,null)),r.a.createElement(T,{ml:1},"\u2022"),r.a.createElement(j,{ml:1,style:{fontStyle:"italic",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",wordBreak:"break-all",wordWrap:"break-word",fontSize:"11px"}},a))},jn=function(e){var t=e.image,n=e.lockedFields,a=e.wantImage,c=void 0===a||a;return r.a.createElement(M,{color:"text.secondary",flex:1,width:"100%"},r.a.createElement(M,{align:"center",pl:1.5,pr:2,justify:"center"},r.a.createElement("div",null,(null!=t||1==c)&&r.a.createElement("img",{src:t||"/assets/icon.png",style:{maxWidth:"180px",height:"90px",objectFit:"cover",backgroundColor:"transparent"}}))),r.a.createElement(j,null,n.slice(0,t?2:3).map((function(e){return r.a.createElement(wn,{key:e.key,maxWidth:"300px",align:"center",mt:1,label:e.property.name,propertyType:e.property.type},r.a.createElement(Cn,{dap:e}))}))))},Ln=function(e){var t,n,a=e.onChangeOptions,c=e.onChangeField,o=e.dap,i=(e.metadatas,e.refresh);return"image"==o.property.type||1==o.fieldOptions.locked?null:"checkbox"==o.property.type?r.a.createElement(j,{mb:1},r.a.createElement(sn,{refresh:i,defaultValue:"boolean"==typeof(null===(t=o.options)||void 0===t?void 0:t.defaultValue)&&(null===(n=o.options)||void 0===n?void 0:n.defaultValue)||!1,propertyName:o.property.name||"empty",onChangeValue:function(e){return a({defaultValue:e})}})):r.a.createElement(j,{mb:1},r.a.createElement(On,{label:o.property.name,propertyType:o.property.type},(function(){var e;switch(o.property.type){case"url":case"title":case"text":case"number":return r.a.createElement(cn,{isNumber:"number"==o.property.type,defaultValue:o.options.defaultValue,onChangeValue:function(e){return a({defaultValue:e})},textClass:"fieldText",name:(null===(e=o.property)||void 0===e?void 0:e.name)||"Untitled"});case"select":return r.a.createElement(fn,{dap:o,textClass:"fieldSelect",onChangeField:c});case"multi_select":return r.a.createElement(gn,{onChangeField:c,textClass:"fieldSelect",dap:o});case"relation":return r.a.createElement(kn,{onChangeOptions:a,textClass:"fieldSelect",dap:o});default:return r.a.createElement(r.a.Fragment,null,"property's type not implemented")}})))},Sn=(n(108).default,n(109).default),Fn=n(180).default,In=n(55).default,Tn=(n(74).default,n(73).default,n(76).default,n(110).default),_n=(n(110).default,n(130).default,n(131).default),Mn=(n(111).default,n(112).default,n(137).default,n(85).default,n(113).default,n(114).default),Vn=(n(72).default,n(84).default,n(61),function(e){var t=Object.assign({},e);return r.a.createElement(j,t,r.a.createElement(M,{justify:"center",align:"center"},r.a.createElement(j,null,r.a.createElement("img",{src:"/assets/icon.png",height:64,width:64})),r.a.createElement(F,null,"Save to Notion"),r.a.createElement(T,null,"version ","0.9.9"),r.a.createElement(M,null,r.a.createElement(M,{mt:2},r.a.createElement(v,{variant:"text",className:"linkButton",onClick:function(){window.open("https://www.notion.so/Save-To-Notion-Changelog-b85cff00e8c24b10a893a6aa18a887fa","_blank")}},"\u2728 changelog"),r.a.createElement(v,{variant:"text",className:"linkButton",onClick:function(){window.open("https://www.notion.so/Save-To-Notion-Tutorials-a8604da6e2864a538efcc777a330266c","_blank")}},"\ud83d\udc68\u200d\ud83c\udf93 tutorials")),r.a.createElement(v,{variant:"text",className:"linkButton",onClick:function(){window.open("https://www.buymeacoffee.com/amibane","_blank")}},"\u2615 donate"),r.a.createElement(v,{variant:"text",className:"linkButton",onClick:function(){window.open("mailto:anis.craheix@gmail.com","_blank")}},"\ud83d\udce9 contact"))))});function Pn(e){var t=e.onClose,n=(e.selectedValue,e.open);return r.a.createElement(Mn,{fullScreen:!0,onClose:t,open:n},r.a.createElement(j,{style:{position:"absolute",right:10,top:5}},r.a.createElement(r.a.Fragment,null,r.a.createElement(In,{onClick:t},r.a.createElement(Sn,{size:"small"})))),r.a.createElement(M,{height:"100%",justify:"center"},r.a.createElement(Vn,null)))}var Dn=function(e){var t=e.onClickOpenOption,n=e.onClickGoBack,a=e.canGoBack,c=e.prevPageName,o=e.rightIcon,i=e.hideAppTitle;return r.a.createElement(r.a.Fragment,null,r.a.createElement(j,{p:.5,pt:1,mb:1,height:"48px"},a?r.a.createElement(r.a.Fragment,null,r.a.createElement(j,{pt:.8,pl:2},r.a.createElement(v,{variant:"text",onClick:n,startIcon:a&&r.a.createElement(Fn,null),disabled:!a},c))):r.a.createElement(r.a.Fragment,null,1==i&&r.a.createElement(r.a.Fragment,null)||r.a.createElement(_,{justify:"center",pt:1.3,align:"center"},r.a.createElement(F,null,"Save to Notion"," ")))),r.a.createElement(j,{style:{position:"absolute",right:10,top:5}},"info"==o?r.a.createElement(P,null,(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(In,{onClick:e.handleOpen},r.a.createElement(_n,{size:"small"})),r.a.createElement(Pn,{open:e.isOpen,onClose:e.handleClose}))})):"settings"==o?r.a.createElement(In,{onClick:t},r.a.createElement(Tn,{size:"small"})):r.a.createElement(r.a.Fragment,null)))},Nn=function(e){var t=e.children,n=e.canGoBack,a=void 0!==n&&n,c=e.optionParams,o=void 0===c?null:c,i=e.onClickGoBack,l=void 0===i?null:i,u=e.prevPageName,s=void 0===u?"":u,p=e.minWidth,d=e.minHeight,m=e.rightIcon,f=e.hideAppTitle,h=r.a.useContext(Qa).openOptionsPage;return r.a.createElement(M,{minWidth:p||"380px",minHeight:d,pb:2},r.a.createElement(Dn,{hideAppTitle:f,prevPageName:s,onClickOpenOption:function(){return h(o)},onClickGoBack:l,canGoBack:a,rightIcon:m||"none"}),r.a.createElement(M,{flex:1,justify:"center"},t))},Rn=n(76).default,zn=function(e){var t=e.msg,n=void 0===t?null:t,a=e.height,c=void 0===a?"300px":a,o=e.minLayoutHeight;return r.a.createElement(Nn,{minHeight:o},r.a.createElement(M,{justify:"center",align:"center",height:c,px:2,py:.5},r.a.createElement(j,{mb:1},r.a.createElement(Rn,{color:"primary",size:20})),r.a.createElement(F,null,n)))},Un=function(e){var t=e.msg;return r.a.createElement(Nn,null,r.a.createElement(M,{justify:"center",align:"center"},r.a.createElement(I,{mb:1,color:"red"},"Error"),r.a.createElement(F,null,t)))},Bn=n(85).default,Zn=n(61);function Hn(e){return Wn.apply(this,arguments)}function Wn(){return(Wn=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Image,e.abrupt("return",new Promise((function(e){n.addEventListener("load",(function(){e({imgUrl:t,width:this.naturalWidth,height:this.naturalHeight})})),n.src=t})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var An=function(e){var t=e.rowId,n=Object(a.useState)(!1),c=Object(m.a)(n,2),o=c[0],i=c[1];function l(){chrome.tabs.create({url:"".concat(o?"notion://":"https://","notion.so/").concat(t)}),window.close()}function s(e){"Enter"==e.code&&l()}return Object(a.useEffect)((function(){Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=i,e.next=3,te.get("open-desktop",!1);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))()}),[]),Object(a.useEffect)((function(){return document.addEventListener("keyup",s),function(){document.removeEventListener("keyup",s)}}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Nn,{hideAppTitle:!1},r.a.createElement(M,{align:"center",justify:"center",px:2,py:.5},r.a.createElement(I,{mb:3,mt:7},"Saved to Notion \u2728"),r.a.createElement(M,{justify:"center",px:1,pb:2},r.a.createElement(pn,{checkboxClass:"checkBoxField",name:"open in desktop app",onChange:function(e){te.set("open-desktop",e),i(e)},value:o,size:"small"})),r.a.createElement(M,{width:"100%"},r.a.createElement(v,{onClick:function(){return l()}},"open in Notion")),r.a.createElement(M,{mt:2,width:"100%"},r.a.createElement(v,{onClick:function(){return window.close()},variant:"outlined"},"close popup")))))},Gn=function(e){var t=e.form,n=e.onUpdateField,a=e.metadatas,c=e.refresh,o=Object(b.a)(e,["form","onUpdateField","metadatas","refresh"]);return B("render",t),r.a.createElement(M,o,t.daps.map((function(e){return r.a.createElement(j,{key:e.key},r.a.createElement(Ln,{onChangeField:n,refresh:c,dap:e,metadatas:a,onChangeOptions:function(t){B("option is:",t),n(Object(p.a)(Object(p.a)({},e),{},{options:t}))}}))})))};function qn(e,t){if(e.startsWith("https://www.youtube.com")){var n=function(e){for(var t,n=/[?&]([^=#]+)=([^&#]*)/g,a={};t=n.exec(e);)a[t[1]]=t[2];return a}(e);if(null===t||void 0===t?void 0:t.includes(n.v))return t;if("v"in n)return"https://i.ytimg.com/vi/".concat(n.v,"/maxresdefault.jpg")}return t}function Jn(e,t){switch(e){case"webpageTitle":return t.title;case"webpageUrl":return t.url;case"domainName":return t.domainName;case"webpageDescription":return t.description;case"webpageImage":return{imgUrl:qn(t.url,t.image),width:null,height:null};case"websiteIcon":return{imgUrl:t.icon,width:null,height:null};default:return""}}var Kn=function(e){var t=e.children,n=e.layoutProps,a=void 0===n?{}:n,c=e.metadatas,o=e.noMargin,i=void 0!==o&&o,l=e.lockedFields,u=e.image;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Nn,a,r.a.createElement(j,{pr:2.5},r.a.createElement(_,{mb:2,pl:3.5},c?r.a.createElement(L,null,r.a.createElement(_,{mb:2,flex:1},r.a.createElement(jn,{lockedFields:l||[{key:"1",property:{id:"xx",name:"Title",type:"any"},options:{defaultValue:Jn("webpageTitle",c)}}],image:u||c.image&&Jn("webpageImage",c).imgUrl||c.icon}))):r.a.createElement(M,null,r.a.createElement(M,{align:"center"},r.a.createElement(Bn,{variant:"rect",height:"90px",width:"115px"})),r.a.createElement(M,{mt:2},r.a.createElement(Bn,{variant:"rect",height:"14px",width:"335px"})))),r.a.createElement(L,{ml:i?0:3.5,mr:.5},t))))};function Yn(e,t,n){return Object(p.a)(Object(p.a)({},t),{},{daps:t.daps.map((function(t){var a=e.daps.find((function(e){var n,a;return(null===(n=e.property)||void 0===n?void 0:n.id)==(null===(a=t.property)||void 0===a?void 0:a.id)}));return a&&t.property.type==a.property.type&&t.options.selectedData==a.options.selectedData?Object(p.a)(Object(p.a)({},t),{},{options:a.options}):Object(p.a)(Object(p.a)({},t),{},{options:t.options.selectedData?{defaultValue:Jn(t.options.selectedData,n)}:t.options})})),needToRefreshTemplate:e.needToRefreshTemplate})}function Xn(e,t,n){var r=Object(a.useRef)(null);Object(a.useEffect)((function(){r.current=e})),Object(a.useEffect)((function(){var e=setInterval((function(){r.current&&r.current()}),t);return function(){clearInterval(e),n&&n()}}),[t])}var Qn=function(e){var t,n,c=e.form,o=e.metadatas,i=e.onGoBack,l=e.canGoBack,s=e.onError,f=e.onChangeForm,h=Object(a.useState)("before_submit"),b=Object(m.a)(h,2),g=b[0],y=b[1],E=r.a.useRef(null),x=r.a.useRef(null),k=Object(a.useState)(c.daps),O=Object(m.a)(k,2),C=O[0];O[1];x.current=c;var w=Object(a.useContext)(Qa),j=w.currentFormHasChanged,L=w.setCurrentFormHasChanged,S=w.fieldDatas,F=w.cleanupFieldDatas,I=w.client,T=c,_=f;Object(a.useEffect)((function(){setTimeout((function(){Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if([],t=x.current.daps.find((function(e){var t,n;return(null===(t=null===(n=e.options)||void 0===n?void 0:n.defaultValue)||void 0===t?void 0:t.imgUrl)&&"pageFrontImage"==e.property.id})),B("here"),t){e.next=5;break}return e.abrupt("return");case 5:return G(!0),B("saving"),e.next=9,Hn(t.options.defaultValue.imgUrl);case 9:n=e.sent,B("img",n),f((function(e){return Object(p.a)(Object(p.a)({},e),{},{daps:e.daps.map((function(e){var t;return"pageFrontImage"==(null===(t=e.property)||void 0===t?void 0:t.id)?Object(p.a)(Object(p.a)({},e),{},{options:{defaultValue:n}}):e}))})})),G(!1);case 13:case"end":return e.stop()}}),e)})))()}),200)}),[]),Object(a.useEffect)((function(){E.current&&clearTimeout(E.current),E.current=setTimeout((function(){Ae({pos:"fillForm",url:o.url,fieldDatas:c.daps.map((function(e){return{key:e.key,options:e.options}})),formId:c.id}),E.current=null}),300)}),[c]),Xn((function(){"before_submit"==g?Ae({pos:"fillForm",url:o.url,fieldDatas:c.daps.map((function(e){return{key:e.key,options:e.options}})),formId:c.id}):Ke()}),1500,(function(){return Ke()})),Object(a.useEffect)((function(){0==j&&(B("LOAD",S),_(Object(p.a)(Object(p.a)({},c),{},{daps:c.daps.map((function(e){var t=null===S||void 0===S?void 0:S.find((function(t){return t.key==e.key}));return Object(p.a)(Object(p.a)({},e),{},{options:(null===t||void 0===t?void 0:t.options)||(e.options.selectedData?{defaultValue:Jn(e.options.selectedData,o)}:e.options)})}))})),Z(!0),setTimeout((function(){Z(!1)}),100),S&&F())}),[]);var V=Object(a.useState)(!0),P=Object(m.a)(V,2),D=P[0],N=P[1],R=Object(a.useState)(!1),z=Object(m.a)(R,2),U=z[0],Z=z[1],H=Object(a.useState)(!1),W=Object(m.a)(H,2),A=W[0],G=W[1],q=Object(a.useState)(""),J=Object(m.a)(q,2),K=(J[0],J[1],Object(a.useState)({})),Y=Object(m.a)(K,2),X=(Y[0],Y[1],Object(a.useState)(null)),Q=Object(m.a)(X,2),$=Q[0],ee=Q[1],te=Object(a.useState)(null),ne=Object(m.a)(te,2),ae=ne[0],re=ne[1],ce=Object(a.useState)([]),oe=Object(m.a)(ce,2),ie=oe[0],le=oe[1];Object(a.useEffect)((function(){le(c.daps.filter((function(e){return"image"!=e.property.type&&e.fieldOptions&&e.fieldOptions.locked}))),re(function(e){var t=e.flatMap((function(e){var t,n;return"image"==e.property.type&&(null===(t=null===(n=e.options)||void 0===n?void 0:n.defaultValue)||void 0===t?void 0:t.imgUrl)&&[e]||[]}));return console.log("images",t),t.sort((function(e,t){var n,a;return"pageFrontImage"==(null===(n=e.property)||void 0===n?void 0:n.id)?-1:"pageFrontImage"==(null===(a=t.property)||void 0===a?void 0:a.id)?1:0})),console.log("sorted images",t),t[0]}(c.daps))}),[c]),Object(a.useEffect)((function(){le(c.daps.filter((function(e){return"image"!=e.property.type&&e.fieldOptions&&e.fieldOptions.locked})))}),[c]),Object(a.useEffect)((function(){j?(N(!1),Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(!1),e.next=3,He(T.id);case 3:t=e.sent,_((function(e){return B("FINAL>>>",e),Yn(e,t,o)}));case 5:case"end":return e.stop()}}),e)})))()):1==D&&(console.log("refreshing collection"),N(!1),ue())}),[D,j]);var ue=Object(a.useCallback)(Object(d.a)(u.a.mark((function e(){var t,n,a,r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B("getting the client..."),e.next=3,ft();case 3:if(t=e.sent,B("respGetClient",t),"error"!=t.status){e.next=9;break}return B(t.errorMsg),s(t.errorMsg),e.abrupt("return");case 9:return B("refreshing the collection...",C),e.next=12,lt(t.client,c.collection,C,{checkTemplateUpToDate:c.template});case 12:if(n=e.sent,a=ct(n,C),B("receiving res",a.collection),B("tomodify",n.fieldsToModify),a.collection){e.next=18;break}return e.abrupt("return");case 18:return a.daps.map((function(e){return e.options.customCss?Object(p.a)(Object(p.a)({},e),{},{options:{customCss:e.options.customCss}}):e})),B("TEST2",a.daps),r=Object(p.a)(Object(p.a)({},c),{},{collection:a.collection,daps:a.daps,template:a.collection.template}),B("TEST",r),e.next=24,Qe(r,"edit",c.id);case 24:o=T.daps.some((function(e){return null!=n.fieldsToModify.find((function(t){return t.key==e.key}))})),B("needREFRESH",o),_((function(e){var t=a.daps.map((function(t){var a=e.daps.find((function(e){return e.key==t.key})),r=n.fieldsToModify.find((function(e){return e.key==t.key}));return B("pos 5",t),r?Object(p.a)(Object(p.a)({},t),{},{property:t.property,options:{}}):Object(p.a)(Object(p.a)({},t),{},{property:t.property,options:a.options})}));return Object(p.a)(Object(p.a)({},e),{},{collection:a.collection,daps:t,needToRefreshTemplate:n.needToRefreshTemplate})})),o&&(B("performing a refresh..."),Z(!0),setTimeout((function(){Z(!1)}),100)),B("refeshing collection is done!"),G(!1);case 30:case"end":return e.stop()}}),e)}))),[c]);switch(Object(a.useEffect)((function(){if("waiting_collection_finish_refreshing"==g&&0==A){y("submitting");try{!function(e,t,n,a,r){t("submitting");var c=chrome.runtime.connect({name:"submit_form_to_notion"});c.postMessage({type:"initial_data",params:{form:e,currentUrl:r}}),c.onMessage.addListener((function(e){switch(e.type){case"submitting":break;case"error":t("error_when_submitting"),c.disconnect();break;case"success_submit":a(e.id.replace(/-/g,"")),t("success_submit"),c.disconnect()}}))}(T,y,0,ee,o.url)}catch(e){B("error!",e),y("error_when_submitting")}}}),[g,A]),g){case"before_submit":return r.a.createElement(Ba.Provider,{value:{spaceId:c.spaceId,createNewPageInCollection:function(e,t){var n={id:Zn(),name:e};return G(!0),Et(n,t),I.createRecord("block",{id:t,_table:"collection"},{id:n.id,type:"page",properties:{title:[[e]]}}).then((function(e){B("page created!",e),G(!1)})),n},getCachedCollectionPages:vt,upsertCachedCollectionPage:Et,createNewValueForProperty:function(e,t,n){B("fetch client"),B("calling addValueProperty",e,t);var a={id:Zn(),value:t,color:n};return G(!0),I.addValueToPropertyCollection(T.collection,e,t,a.id,a.color).then((function(e){N(!0)})),a},refreshCollection:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:B("calling refresh collection");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}},r.a.createElement(Kn,{metadatas:o,layoutProps:{canGoBack:l,prevPageName:"form '".concat(c.name,"'"),onClickGoBack:i,optionParams:{action:"edit",id:c.id,databaseLocked:!0},rightIcon:"settings"},lockedFields:ie,image:null===(t=null===ae||void 0===ae||null===(n=ae.options)||void 0===n?void 0:n.defaultValue)||void 0===t?void 0:t.imgUrl},r.a.createElement(M,null,null!=o&&r.a.createElement(Gn,{refresh:U,form:T,metadatas:o,onUpdateField:function(e){_(Object(p.a)(Object(p.a)({},T),{},{daps:T.daps.map((function(t){return t.key==e.key?e:t}))}))}})),r.a.createElement(M,{justify:"center",mt:1.5},r.a.createElement(M,{width:"100%"},r.a.createElement(v,{onClick:Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:B("handling submit",T),y("waiting_collection_finish_refreshing");case 2:case"end":return e.stop()}}),e)}))),size:"large"},"Save To Notion")))));case"waiting_collection_finish_refreshing":return r.a.createElement(zn,{msg:"prepare to save to Notion...",height:"240px"});case"submitting":return r.a.createElement(zn,{msg:"saving to Notion...",height:"240px"});case"error_when_submitting":return r.a.createElement(Un,{msg:"unkown error when submitting"});case"success_submit":return r.a.createElement(An,{rowId:$})}},$n=(n(211).default,n(109).default,n(194).default,n(212).default,n(213).default,n(75).default,n(181).default,n(197).default,n(214).default,n(85).default),ea=(n(182).default,n(83).default),ta=n(76).default,na=n(61),aa=n(133).default,ra=(n(74).default,n(73).default,n(55).default),ca=(n(183).default,n(72).default),oa=n(84).default,ia=(n(82).default,n(113).default,n(114).default,n(215).default,n(216).default,n(138).default,n(134).default,n(136).default,n(108).default,n(107).default,n(217).default),la=n(184).default,ua=(n(185).default,n(186).default),sa=r.a.createContext({collection:null}),pa=function(e){var t=e.collection,n=e.onChangeProperty,c=e.property,o=e.daps,l=Object(a.useState)(c?[c]:[]),u=Object(m.a)(l,2),s=u[0],d=u[1],f=Object(a.useContext)(Ta).refreshCollection,h=Object(a.useMemo)((function(){var e=[];for(var n in t.schema){var a=t.schema[n];a.valid=!1,["text","select","multi_select","url","title","checkbox","relation","number"].includes(a.type)&&(a.valid=!0),a.id=n,e.push(a)}return e.push({name:"cover",id:"pageCover",type:"image",valid:!0}),e.push({name:"cover image",id:"pageFrontImage",type:"image",valid:!0}),e.push({name:"icon",id:"pageIcon",type:"image",valid:!0}),e}),[t]),g=Object(a.useMemo)((function(){var e,t={},n=Object(i.a)(o);try{for(n.s();!(e=n.n()).done;){var a=e.value;a.property&&(t[a.property.id]=!0)}}catch(r){n.e(r)}finally{n.f()}return t}),[o,h]),v=Object(a.useMemo)((function(){var e,t=h.map((function(e){return Object(p.a)({},e)})),n=Object(i.a)(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;!(a.id in g)||0!=s.length&&s[0].id==a.id||(a.valid=!1)}}catch(r){n.e(r)}finally{n.f()}return t}),[s,g]);return Object(a.useEffect)((function(){c&&d([c])}),[c]),r.a.createElement(r.a.Fragment,null,r.a.createElement(ea,{multiple:!0,onOpen:function(){B("refreshing collection..."),f()},size:"small",value:s,blurOnSelect:!0,options:v,renderTags:function(e,t){return e.map((function(e,n){var a=t({index:n}),c=a.key,o=Object(b.a)(a,["key"]);return r.a.createElement(Mt,{option:e,key:c,"data-tag-index":o["data-tag-index"]})}))},getOptionLabel:function(e){return e.name},getOptionSelected:function(e,t){return e.name==t.name},renderOption:function(e){return r.a.createElement(Mt,{option:e})},style:{width:200},getOptionDisabled:function(e){return 0==e.valid},onChange:function(e,t,a){if(0==t.length)d([]),n(null);else{var r=t[t.length-1];d([r]),n(r)}},renderInput:function(e){return r.a.createElement(x,Object.assign({className:"propertyField",onClick:e.inputProps.onMouseDown},e,{inputProps:Object(p.a)(Object(p.a)({},e.inputProps),{},{onMouseDown:null}),placeholder:0==s.length?"select a property...":"",variant:"outlined"}))}}))};var da=[{type:"data",name:"Page Url",key:"webpageUrl",acceptedPropertyTypes:["url","text"],description:"Url of the page you are visiting when completing the form",example:"https://www.youtube.com/watch?v=dQw4w9WgXcQ"},{type:"data",name:"Page Title",key:"webpageTitle",acceptedPropertyTypes:["title","text"],description:"",example:"Rick Astley - Never Gonna Give You Up (Video) - YouTube"},{type:"data",name:"Page Description",key:"webpageDescription",acceptedPropertyTypes:["text"],description:"",example:"Rick Astley's official music video for \u201cNever Gonna Give You Up\u201d..."},{type:"data",name:"Page Image",key:"webpageImage",acceptedPropertyTypes:["image"],description:"cover image of the page",example:""},{type:"data",name:"Website Icon",key:"websiteIcon",acceptedPropertyTypes:["image"],description:"",example:""}];var ma=function(e){var t=e.title,n=e.iconComp;return r.a.createElement(r.a.Fragment,null,r.a.createElement(_,{align:"center"},r.a.createElement(j,{mr:1},n),r.a.createElement("div",{style:{fontSize:"14px"}},t)))},fa=function(e){var t=e.anchorEl,n=e.open,a=e.onClose,c=e.onClickRemove;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ca,{anchorEl:t,keepMounted:!0,open:n,onClose:a},r.a.createElement(oa,{onClick:function(e){a(),c()}},r.a.createElement(ma,{title:"Delete Field",iconComp:r.a.createElement(ue,null)}))))},ha=function(e){var t=e.onClose,n=e.onOpen,a=e.children,c=r.a.useState(!1),o=Object(m.a)(c,2),i=o[0],l=o[1];return r.a.createElement(r.a.Fragment,null,a({handleOpen:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l(!0),e.t0=n,!e.t0){e.next=5;break}return e.next=5,n();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),handleClose:function(){var e=Object(d.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l(!1),e.t0=t,!e.t0){e.next=5;break}return e.next=5,t(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),isOpen:i}))},ba=Object(St.c)((function(e){var t=e.onClickRemove,n=r.a.useState(null),a=Object(m.a)(n,2),c=a[0],o=a[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(ha,null,(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(j,{mr:.5,className:"boxButtonShowOnlyOnHover",onClick:function(t){o(t.currentTarget),e.handleOpen()}},r.a.createElement(le,null)),r.a.createElement(fa,{anchorEl:c,onClose:function(){e.handleClose(),o(null)},onClickRemove:t,open:e.isOpen}))})))})),ga=function(e){var t=e.field,n=e.onChangeField,a=e.onChangeOptions;return t.property?r.a.createElement(r.a.Fragment,null,function(){switch(B("here"),t.property.type){case"image":return r.a.createElement(r.a.Fragment,null,r.a.createElement(mn,{value:t.options.selectedData,options:da.filter((function(e){return e.acceptedPropertyTypes.some((function(e){return e==t.property.type}))})),onSelectOption:function(e){B("choose",e),a({selectedData:e})},uniqueKey:"key",renderValue:function(e){var t=da.find((function(t){return t.key==e}));return r.a.createElement(ln,{data:t})},renderOption:function(e){return r.a.createElement(on,{data:e})},style:{width:"200px",fontSize:"13px",height:"40px"},className:"propertyField"}));case"url":case"title":case"text":case"number":return r.a.createElement(r.a.Fragment,null,r.a.createElement(un,{name:t.property.name,datas:da.filter((function(e){return e.acceptedPropertyTypes.some((function(e){return e==t.property.type}))})),options:t.options,onSetOptions:a,textStyle:{width:"200px"},textClass:"propertyField"}));case"select":return r.a.createElement(fn,{dap:t,size:"small",onChangeField:n,textStyle:{width:"200px"},textClass:"propertyField"});case"relation":return r.a.createElement(kn,{dap:t,size:"small",onChangeOptions:a,textStyle:{width:"200px"},textClass:"propertyField"});case"multi_select":return r.a.createElement(gn,{onChangeField:n,size:"small",dap:t,textStyle:{width:"200px"},textClass:"propertyField"});case"checkbox":return r.a.createElement(pn,{name:t.property.name,value:t.options.defaultValue,size:"small",onChange:function(e){return a({defaultValue:e})},checkboxStyle:{width:"200px",userSelect:"none",marginLeft:0,marginRight:0},checkboxClass:"propertyField"});default:return r.a.createElement(_,{py:"5px",pl:"8px",pr:"5px",className:"selectDataBox"},"property's type not implemented")}}()):r.a.createElement(_,{pl:"8px",pr:"5px",className:"selectDataBox",color:"#9e9e9e",align:"center"},"choose property")},va=Object(St.b)((function(e){var t,n,c,o=e.dap,i=e.onChangeDap,l=e.onClickRemoveDap,u=e.daps,s=Object(a.useContext)(sa).collection,d=Object(a.useState)(null),f=Object(m.a)(d,2),h=(f[0],f[1],Object(a.useState)(!1)),b=Object(m.a)(h,2),g=(b[0],b[1],r.a.useState(!1)),v=Object(m.a)(g,2);v[0],v[1];return B("dap",null===(t=o.property)||void 0===t?void 0:t.name,o.options),r.a.createElement(r.a.Fragment,null,r.a.createElement(_,{justify:"space-between",align:"center",mt:1,className:"boxItemParent"},r.a.createElement(_,{align:"center",flex:1},r.a.createElement(ba,{onClickRemove:l}),r.a.createElement(pa,{collection:s,property:o.property,onChangeProperty:function(e){i(function(e,t){var n={},a={locked:!1};if(t)switch(t.type){case"image":n={selectedData:"pageIcon"==t.id?"websiteIcon":"webpageImage"},a={locked:!1,image:{type:"coverLike",size:"normal"}};break;case"title":n={selectedData:"webpageTitle"};break;case"url":n={selectedData:"webpageUrl"};break;case"checkbox":n={defaultValue:!1}}return Object(p.a)(Object(p.a)({},e),{},{property:t,options:n,fieldOptions:a})}(o,e))},daps:u}),r.a.createElement(_,{align:"center",flex:1,ml:1,style:o.property?{}:{pointerEvents:"none",opacity:.5}},r.a.createElement(_,{flex:1},r.a.createElement(ga,{field:o,onChangeOptions:function(e){B("save option",o.property.name,e),i(Object(p.a)(Object(p.a)({},o),{},{options:e}))},onChangeField:i}),"image"!=(null===(n=o.property)||void 0===n?void 0:n.type)&&r.a.createElement(_,{className:"lockButton",ml:2},r.a.createElement(ra,{onClick:function(){var e;i(Object(p.a)(Object(p.a)({},o),{},{fieldOptions:Object(p.a)(Object(p.a)({},o.fieldOptions||{}),{},{locked:0==(null===(e=o.fieldOptions)||void 0===e?void 0:e.locked)})}))}},(null===(c=o.fieldOptions)||void 0===c?void 0:c.locked)?r.a.createElement(la,{size:"small"}):r.a.createElement(ua,{size:"small"}))))))))})),ya=Object(St.a)((function(e){var t=e.daps,n=e.onChangeDaps;return r.a.createElement(M,null,t.map((function(e,a){return r.a.createElement(va,{key:e.key,index:a,dap:e,onChangeDap:function(e){n(t.map((function(t,n){return n==a?e:t})))},onClickRemoveDap:function(){return n(t.filter((function(t){return e.key!=t.key})))},daps:t})})))})),Ea=function(e){var t=e.daps,n=e.onSetDaps;return r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{mb:2,mt:2},r.a.createElement(_,{align:"center"},r.a.createElement(F,{ml:3,mb:.5},"Fields")),r.a.createElement(j,null,r.a.createElement(M,null,t.length?r.a.createElement(ya,{daps:t,onChangeDaps:function(e){return n(e)},onSortEnd:function(e){var a=e.oldIndex,r=e.newIndex;return n(Ft(t,a,r))},useDragHandle:!0,lockToContainerEdges:!0,distance:5,lockAxis:"y"}):r.a.createElement(T,{fontStyle:"italic",mt:1},"no fields, please add one"),r.a.createElement(_,{mt:1,ml:3,className:"addFormButton",align:"center",component:"button",onClick:function(){n([].concat(Object(s.a)(t),[{kind:"data",key:U(4),options:{},fieldOptions:{locked:!1}}]))}},r.a.createElement(se,null),r.a.createElement("div",null,"New Field"))))))};var xa=function(e){var t=e.defaultName,n=e.onChangeName,c=Object(a.useState)(""),o=Object(m.a)(c,2),i=o[0],l=o[1];return Object(a.useEffect)((function(){t!=i&&l(t)}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Bt.a,{name:"form-field-name",className:"nameInput",value:i,inputStyle:{border:"0",fontSize:"20px",fontWeight:"bold"},onKeyDown:function(e){"Enter"===e.key&&(e.target.blur(),e.preventDefault())},onFocus:function(e){return e.target.select()},autoComplete:"off",onChange:function(e){l(e.target.value)},onBlur:function(){B("blured"),n(i.length&&i||"Untitled")}}))},ka={name:"New Form",daps:[],id:"",spaceId:""},Oa=function(e){var t=e.spaceId,n=e.onSelectSpaceId,c=e.disabled,o=Object(a.useContext)(Qa).client;return Object(a.useEffect)((function(){""==t&&(B("got spaces",o.user.spaces[0]),n(o.user.spaces[0].id))}),[t]),r.a.createElement(_,{align:"center",flex:1},r.a.createElement(j,{style:{minWidth:"200px",fontSize:"1rem",marginRight:"28px",fontWeight:400}},r.a.createElement(Mt,{option:{name:"Workspace",type:"workspace"}})),r.a.createElement(_,{flex:1},r.a.createElement(mn,{disabled:c,value:t,options:o.user.spaces,onSelectOption:function(e){n(e)},uniqueKey:"id",renderValue:function(e){var t=o.user.spaces.find((function(t){return t.id==e}));return r.a.createElement(xn,{iconComp:r.a.createElement("div",{style:{marginRight:"8px"}}),name:(null===t||void 0===t?void 0:t.name)||"",className:"selectedDataOptionRow"})},renderOption:function(e){return r.a.createElement(xn,{name:(null===e||void 0===e?void 0:e.name)||"",className:"selectedDataOptionRow"})},style:{width:"200px",fontSize:"13px",height:"40px"},className:"propertyField"})))},Ca=function(e){var t=e.savePageContent,n=e.onSavePageContentToggle;return r.a.createElement(r.a.Fragment,null,r.a.createElement(_,{align:"center",flex:1,ml:1},r.a.createElement(j,{style:{minWidth:"200px",marginLeft:"20px",fontSize:"1rem",fontWeight:400}},r.a.createElement(Mt,{option:{name:"Save Page Content",type:"saveContent"}})),r.a.createElement(pn,{name:"Save Page Content",value:t,onChange:n,size:"small",checkboxStyle:{width:"200px",userSelect:"none",marginLeft:0,marginRight:0},checkboxClass:"propertyField"})))},wa=function(e){var t=e.templateId,n=e.onSelectTemplateId,c=e.templates,o=e.template,i=Object(a.useContext)(Qa).client,l=Object(a.useContext)(Ta).refreshCollection;return r.a.createElement(r.a.Fragment,null,r.a.createElement(_,{align:"center",flex:1,ml:1},r.a.createElement(j,{style:{minWidth:"200px",marginLeft:"20px",fontSize:"1rem",fontWeight:400}},r.a.createElement(Mt,{option:{name:"Template",type:"template"}})),r.a.createElement(_,{flex:1},r.a.createElement(mn,{displayEmpty:!0,value:t,options:c.length?c:o?[o]:[],onOpen:function(){B("openened template, refreshing collection..."),l()},onSelectOption:function(e){n(e)},uniqueKey:"id",renderValue:function(e){var t=c.find((function(t){return t.id==e}));return t?r.a.createElement(xn,{name:(null===t||void 0===t?void 0:t.name)||"",pageId:t.id,icon:t.icon,userId:i.user.id}):r.a.createElement(r.a.Fragment,null)},renderValueEmpty:function(){return r.a.createElement(xn,{iconComp:r.a.createElement("div",{style:{marginRight:"8px"}},r.a.createElement(fe,null)),name:"None"})},renderOptionEmpty:function(){return r.a.createElement(xn,{iconComp:r.a.createElement("div",{style:{marginRight:"8px"}},r.a.createElement(fe,null)),name:"None"})},renderOption:function(e){return r.a.createElement(xn,{pageId:e.id,icon:e.icon,userId:i.user.id,name:(null===e||void 0===e?void 0:e.name)||""})},style:{width:"200px",fontSize:"13px",height:"40px"},className:"propertyField"}))))};function ja(e){for(var t=U(4);t in e;)t=U(4);return t}function La(e,t){return Sa.apply(this,arguments)}function Sa(){return(Sa=Object(d.a)(u.a.mark((function e(t,n){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.schema,B("got",t),r=ja(a),a[r]={name:"URL",type:"url"},e.next=6,n._submitTransaction([{id:t.id,table:"collection",path:[],command:"update",args:{schema:a}}]);case 6:return e.abrupt("return",Object(p.a)(Object(p.a)({},a[r]),{},{id:r}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fa(e,t,n){return Ia.apply(this,arguments)}function Ia(){return(Ia=Object(d.a)(u.a.mark((function e(t,n,a){var r,c,o,i,l,s,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=null,c=null,e.t0=u.a.keys(t.schema);case 3:if((e.t1=e.t0()).done){e.next=16;break}if(o=e.t1.value,"title"!=(i=t.schema[o]).type){e.next=10;break}if(r={kind:"data",key:U(4),options:{selectedData:"webpageTitle"},property:Object(p.a)(Object(p.a)({},i),{},{id:o}),fieldOptions:{locked:!0}},!c){e.next=10;break}return e.abrupt("break",16);case 10:if("url"!=i.type){e.next=14;break}if(c={kind:"data",key:U(4),options:{selectedData:"webpageUrl"},property:Object(p.a)(Object(p.a)({},i),{},{id:o}),fieldOptions:{locked:!0}},!r){e.next=14;break}return e.abrupt("break",16);case 14:e.next=3;break;case 16:if(null!=c){e.next=32;break}return a(!0),e.prev=18,e.t2=U(4),e.t3={selectedData:"webpageUrl"},e.next=23,La(t,n);case 23:e.t4=e.sent,e.t5={locked:!0},c={kind:"data",key:e.t2,options:e.t3,property:e.t4,fieldOptions:e.t5},e.next=31;break;case 28:e.prev=28,e.t6=e.catch(18),console.log("error when creating new url property",e.t6);case 31:a(!1);case 32:return B(c),l=[],s={kind:"data",key:U(4),options:{selectedData:"webpageImage"},property:{name:"front image",id:"pageFrontImage",type:"image"},fieldOptions:{locked:!0,image:{size:"normal",type:"coverLike"}}},d={kind:"data",key:U(4),options:{selectedData:"websiteIcon"},property:{name:"icon",id:"pageIcon",type:"image"},fieldOptions:{locked:!0,image:{size:"normal",type:"coverLike"}}},l.push(d),l.push(s),c&&l.push(c),r&&l.push(r),e.abrupt("return",l);case 41:case"end":return e.stop()}}),e,null,[[18,28]])})))).apply(this,arguments)}var Ta=r.a.createContext(null),_a=function(e){var t=Object.assign({},e);return r.a.createElement(j,t,r.a.createElement(M,null,r.a.createElement($n,{variant:"text",height:"40px",width:"50px"}),r.a.createElement($n,{variant:"text",height:"40px",width:"470px"}),r.a.createElement($n,{variant:"text",height:"40px",width:"470px"}),r.a.createElement($n,{variant:"text",height:"40px",width:"470px"})))},Ma=function(e){var t,n=e.currentUrl,c=Object(b.a)(e,["currentUrl"]),o=Object(a.useState)(ka),i=Object(m.a)(o,2),l=i[0],s=i[1],f=Object(a.useState)(!1),h=Object(m.a)(f,2),g=h[0],y=h[1],E=Object(a.useState)(c.id||null),x=Object(m.a)(E,2),k=x[0],O=(x[1],r.a.useRef(null)),C=function(e){return O.current?B("ignore timeout"):(B("record timeout"),O.current=setTimeout((function(){B("Save!!!"),O.current=null}),200)),s(e)},w=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B("saveSync"),e.next=3,Qe(l,c.action,c.id);case 3:H(!0),c.databaseLocked&&W(!0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Xn((function(){B("save pos"),Ae({pos:"settings",url:n,formId:k})}),1500,(function(){return Ke()}));var S=V({collection_refresh:!0,formdata:!0}),I=(S.allDone,S.setLoaded),T=S.loadStates,P=Object(a.useState)("loading"),D=Object(m.a)(P,2),N=D[0],R=D[1];Object(a.useEffect)((function(){"new"==c.action?setTimeout((function(){R("ok")}),200):Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("edit"!=c.action){e.next=9;break}return console.log("fetching data..."),e.next=4,He(c.id);case 4:t=e.sent,B("got","data:",l,c,t,c),s(t),I("formdata"),R("ok");case 9:case"end":return e.stop()}}),e)})))()}),[]);var z=Object(a.useCallback)((function(e){return C((function(t){return Object(p.a)(Object(p.a)({},t),e)}))}),[l]),U=Object(a.useContext)(Qa),Z=U.client,H=U.setFormListHasChanged,W=U.setCurrentFormHasChanged,A=Object(a.useState)(!0),G=Object(m.a)(A,2),q=(G[0],G[1],function(){lt(Z,l.collection,l.daps,{getTemplatesInfo:!0,checkTemplateUpToDate:l.template}).then((function(e){C((function(t){return Object(p.a)({},function(e,t){var n=ct(e,t.daps),a=n.collection,r=n.daps;return Object(p.a)(Object(p.a)({},t),{},{collection:a,daps:r,template:!e.needToRemoveTemplate&&t.template||void 0,needToRefreshTemplate:e.needToRefreshTemplate})}(e,t))}))}))});return Object(a.useEffect)((function(){1==T.formdata&&l.collection&&(B("perform update..."),q())}),[T]),Object(a.useEffect)((function(){}),[l]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"editForm"},r.a.createElement(Ta.Provider,{value:{refreshCollection:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:q();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}},r.a.createElement(aa,{style:{color:"white",zIndex:2},open:"loading_refresh_collection"==N},r.a.createElement(ta,{color:"inherit"})),r.a.createElement(L,{py:2,px:4,width:"500px"},r.a.createElement(j,{minHeight:"60px"}),r.a.createElement(ia,{style:{padding:"8px",minWidth:"500px",backgroundColor:"white",height:"55px"}},r.a.createElement(_,{align:"center",justify:"center"},r.a.createElement(r.a.Fragment,null,"loading"==N?r.a.createElement(r.a.Fragment,null,r.a.createElement($n,{variant:"rect",height:"40px",width:"200px"})):r.a.createElement(xa,{defaultName:l.name,onChangeName:function(e){return z({name:e})}}))),r.a.createElement(j,{style:{position:"fixed",right:10}},r.a.createElement(r.a.Fragment,null,!(null===l||void 0===l?void 0:l.collection)&&r.a.createElement(v,{onClick:function(){return wt()},variant:"text"},"cancel")||r.a.createElement(v,{variant:"text",onClick:Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(">>>>>>>>>>>>>>>>>>",l,c),e.next=3,w();case 3:wt();case 4:case"end":return e.stop()}}),e)})))},"save")))),"loading"==N?r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{mb:2},r.a.createElement(_a,{mb:2}),"edit"==c.action&&r.a.createElement(_a,null))):r.a.createElement(r.a.Fragment,null,r.a.createElement(M,null,r.a.createElement(M,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(F,{mb:.5,ml:3},"Database"),r.a.createElement(j,{mb:.5},r.a.createElement(Oa,{spaceId:l.spaceId,disabled:!1,onSelectSpaceId:function(e){l.spaceId!=e&&(z({spaceId:e,collection:void 0}),k&&(B("delete formId"),function(e){Xe.apply(this,arguments)}(k)))}})),r.a.createElement(j,{mb:.5},r.a.createElement(zt,{disabled:!1,collection:l.collection,spaceId:l.spaceId,onSelectCollection:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.name,a=l.daps,t){e.next=9;break}return z({collection:t,name:n="New Form",daps:a=[]}),e.abrupt("return");case 9:"New Form"==l.name&&(n="".concat(t.icon&&!t.icon.startsWith("http")?"".concat(t.icon," "):"").concat(t.name[0][0]));case 10:if(!(l.collection&&l.collection.id!=t.id||0==l.daps.length)){e.next=15;break}return B("update daps..."),e.next=14,Fa(t,Z,y);case 14:a=e.sent;case 15:z({collection:t,name:n,daps:a,template:void 0});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),daps:l.daps}))),g&&r.a.createElement(_a,{mt:2}),l.collection&&r.a.createElement(j,{mt:2},r.a.createElement(M,null,r.a.createElement(F,{mb:.5,ml:3},"Options"),r.a.createElement(j,null,r.a.createElement(wa,{templateId:(null===(t=l.template)||void 0===t?void 0:t.id)||"",template:l.template,templates:l.collection.templatesInfo||[],onSelectTemplateId:function(e){var t;z({template:null===(t=l.collection.templatesInfo)||void 0===t?void 0:t.find((function(t){return t.id==e}))})}})),r.a.createElement(j,{mt:.5},r.a.createElement(Ca,{onSavePageContentToggle:function(e){z({savePageContent:e})},savePageContent:l.savePageContent||!1}))))))),l.collection&&r.a.createElement(Ba.Provider,{value:{spaceId:l.spaceId,createNewPageInCollection:function(e,t){var n={id:na(),name:e};return Et(n,t),Z.createRecord("block",{id:t,_table:"collection"},{id:n.id,type:"page",properties:{title:[[e]]}}).then((function(e){B("page created!",e)})),n},getCachedCollectionPages:vt,upsertCachedCollectionPage:Et,createNewValueForProperty:function(e,t,n){B("fetch client"),B("calling addValueProperty",e,t);var a={id:na(),value:t,color:n};return Z.addValueToPropertyCollection(l.collection,e,t,a.id,a.color).then((function(e){q()})),a},refreshCollection:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:B("calling refresh collection");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}},r.a.createElement(sa.Provider,{value:{collection:l.collection}},r.a.createElement(Ea,{daps:l.daps,onSetDaps:function(e){return z({daps:e})}})))))))},Va=(n(61),n(108).default,n(109).default,n(187).default),Pa=(n(55).default,n(74).default,n(73).default,n(76).default),Da=(n(188).default,n(189).default),Na=n(110).default,Ra=(n(130).default,n(131).default,n(111).default,n(112).default,n(137).default,n(85).default,n(113).default,n(114).default,n(72).default),za=n(84).default;function Ua(){return new Promise((function(e){chrome.tabs.query({active:!0,currentWindow:!0},(function(t){0!=t.length?e({title:t[0].title,url:t[0].url}):e(void 0)}))}))}var Ba=r.a.createContext({}),Za=(Object(St.c)((function(e){return Object(f.a)(e),r.a.createElement("div",{style:{cursor:"grab"}},r.a.createElement(le,null))})),function(e){var t=e.title,n=e.iconComp;return r.a.createElement(r.a.Fragment,null,r.a.createElement(_,{align:"center"},r.a.createElement(j,{mr:1},n),r.a.createElement("div",{style:{fontSize:"13px"}},t)))}),Ha=function(e){var t=e.anchorEl,n=(e.open,e.onClose),a=e.onClickRemove,c=e.onEdit,o=e.onFav,i=e.onClickDuplicate,l=e.isFavorite,u=e.canFavorite,s=e.disabledClick;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ra,{anchorEl:t,keepMounted:!0,open:Boolean(t),onClose:n},1==s&&r.a.createElement(za,{onClick:c},r.a.createElement(Za,{title:"Edit Form",iconComp:r.a.createElement(Na,{style:{fontSize:"20px",paddingTop:"5px",color:"rgba(0, 0, 0, 0.83)"}})})),u&&r.a.createElement(za,{onClick:function(){n(),o()}},r.a.createElement(Za,{title:l?"Unset Focus Form":"Set as Focus Form",iconComp:r.a.createElement(Da,{style:{fontSize:"20px",paddingTop:"5px",color:"rgba(0, 0, 0, 0.83)"}})})),r.a.createElement(za,{onClick:function(){n(),i()}},r.a.createElement(Za,{title:"Duplicate Form",iconComp:r.a.createElement(pe,null)})),r.a.createElement(za,{onClick:function(){n(),a()}},r.a.createElement(Za,{title:"Delete Form",iconComp:r.a.createElement(ue,null)}))))},Wa=Object(St.c)((function(e){var t=e.onEdit,n=e.onClickDuplicate,a=e.onClickRemove,c=e.isFavorite,o=e.canFavorite,i=e.onFav,l=e.disabledClick,u=r.a.useState(null),s=Object(m.a)(u,2),p=s[0],d=s[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(P,null,(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(j,{mr:.5,className:"boxButtonShowOnlyOnHover",onClick:function(t){d(t.currentTarget),e.handleOpen()}},r.a.createElement(le,null)),r.a.createElement(Ha,{anchorEl:p,onEdit:t,disabledClick:l,onFav:i,onClose:function(){e.handleClose(),d(null)},canFavorite:o,isFavorite:c,onClickRemove:a,onClickDuplicate:n,open:e.isOpen}))})))})),Aa=Object(St.b)((function(e){var t=e.form,n=e.onClickRemove,a=e.onDuplicate,c=e.disabledClick,o=(e.formsCount,e.onSelectForm),i=e.onToggleFavoriteForm,l=e.isFavorite,u=e.canFavorite,s=r.a.useContext(Qa).openOptionsPage;return r.a.createElement(_,{align:"center",mb:1,width:"100%",className:"boxItemParent"},r.a.createElement(Wa,{onEdit:function(){s({action:"edit",id:t.id})},onFav:function(){return i(t.id)},isFavorite:l,disabledClick:c,canFavorite:u,onClickRemove:n,onClickDuplicate:a}),r.a.createElement(_,{flex:1,className:"".concat(c?"disabledBox":""," chooseBox"),align:"center",justify:"space-between",key:t.id,onClick:function(){return!c&&o(t)},component:"button",disabled:c,style:c&&{color:"grey"}||l&&{background:"#e8e7cf"}||{}},r.a.createElement("div",null,r.a.createElement(T,null,t.name)),r.a.createElement(Va,{style:{color:"grey"}})))})),Ga=Object(St.a)((function(e){var t=e.forms,n=e.canSavePage,a=e.onClickRemoveFormItem,c=e.onDuplicateItem,o=e.onSelectForm,i=e.onToggleFavoriteForm;return B("can save page",n),r.a.createElement(M,null,t.map((function(e,l){return r.a.createElement(Aa,{key:e.id,index:l,form:e,disabledClick:!n,formsCount:t.length,canFavorite:t.length>1,isFavorite:1!=t.length&&!0===e.favorite,onClickRemove:function(){return a(e.id)},onDuplicate:function(){return c(e)},onSelectForm:o,onToggleFavoriteForm:i})})))})),qa=function(e){var t=e.metadatas;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Kn,{metadatas:t},r.a.createElement(j,{my:2},r.a.createElement(Pa,{color:"primary",size:20}))),")")},Ja=function(e){var t=e.forms,n=e.onSelectForm,a=e.metadatas,c=e.canSavePage,o=e.onChangeForms,i=e.connectedToNotion,l=r.a.useContext(Qa).openOptionsPage;return i?r.a.createElement(Kn,{metadatas:a,layoutProps:{rightIcon:"info"},noMargin:!0},r.a.createElement(M,{pl:"6px"},r.a.createElement(Ga,{forms:t,useDragHandle:!0,canSavePage:c,onSortEnd:function(e){var n,a,r,c=e.oldIndex,i=e.newIndex;document.body.style.cursor="default",c!=i&&o((a=c,r=i,function(e,t,n){var a=n<0?e.length+n:n,r=e.splice(t,1)[0];e.splice(a,0,r)}(n=(n=t).slice(),a,r),n))},onSelectForm:n,onClickRemoveFormItem:function(e){o(t.filter((function(t){return t.id!=e})))},onDuplicateItem:function(){var e=Object(d.a)(u.a.mark((function e(n){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,He(n.id);case 2:return a=e.sent,e.next=5,Qe(Object(p.a)(Object(p.a)({},a),{},{name:"".concat(n.name," (Copy)")}),"new",null);case 5:r=e.sent,o([].concat(Object(s.a)(t),[r]));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onToggleFavoriteForm:function(e){o(t.map((function(t){return Object(p.a)(Object(p.a)({},t),{},{favorite:t.id==e&&!t.favorite})})))},onSortStart:function(){return document.body.style.cursor="grabbing"},lockAxis:"y",lockToContainerEdges:!0,distance:5})),0==t.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{ml:3.5},r.a.createElement(v,{onClick:function(){return l({action:"new"})}},"Create a form"))):r.a.createElement(j,{ml:3.5},r.a.createElement(_,{className:"addFormButton",align:"center",component:"button",onClick:function(){return l({action:"new"})},style:{}},r.a.createElement(se,null),"New Form"))):r.a.createElement(Kn,{metadatas:a,layoutProps:{rightIcon:"info"},noMargin:!0},r.a.createElement(M,{align:"center",mb:1},r.a.createElement(F,null,"Hello \ud83d\udc4b "),r.a.createElement(F,{mb:3}," To save this page, please log in to Notion"),r.a.createElement(v,{onClick:function(){chrome.tabs.create({url:"https://www.notion.so/login"}),window.close()}},"Log in to Notion")))};function Ka(){return Ya.apply(this,arguments)}function Ya(){return(Ya=Object(d.a)(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ua();case 2:if((a=e.sent)&&(null===(t=a.url)||void 0===t?void 0:t.startsWith("http"))&&!(null===(n=a.url)||void 0===n?void 0:n.includes("chrome.google.com"))){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",new Promise((function(e){var t=chrome.runtime.connect({name:"get_metadatas"});t.onDisconnect.addListener((function(){e(null),console.log("disconnected")})),t.onMessage.addListener((function(n){switch(console.log("received",n),n.type){case"done":e(n.data),t.disconnect();break;case"error":e(null)}}))})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Xa={need_to_login_to_notion:"You are not connected to Notion, please go on notion.so, log in, then reload this page",cookie_expired:"your session with Notion expired, you need to log in again"},Qa=r.a.createContext(null);function $a(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function er(e){return e.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,(function(e,t){return 0===+e?"":0===t?e.toLowerCase():e.toUpperCase()}))}var tr=function(){var e=Object(a.useState)("loading"),t=Object(m.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)([]),i=Object(m.a)(o,2),l=i[0],s=i[1],f=Object(a.useState)(null),h=Object(m.a)(f,2),b=h[0],g=h[1],v=Object(a.useState)(null),y=Object(m.a)(v,2),E=y[0],x=y[1],k=Object(a.useState)(null),O=Object(m.a)(k,2),C=O[0],w=O[1],j=Object(a.useState)(null),L=Object(m.a)(j,2),S=L[0],F=L[1],I=Object(a.useState)(!0),T=Object(m.a)(I,2),_=T[0],M=(T[1],Object(a.useState)(null)),P=Object(m.a)(M,2),N=P[0],R=P[1],z=Object(a.useState)(!0),U=Object(m.a)(z,2),H=U[0],W=U[1],A=Object(a.useState)(!1),G=Object(m.a)(A,2),q=G[0],J=G[1],K=Object(a.useState)(!1),Y=Object(m.a)(K,2),X=Y[0],Q=Y[1],$=Object(a.useState)(null),ee=Object(m.a)($,2),ne=(ee[0],ee[1],V({notionClient:!0,forms:!0})),ae=(ne.allDone,ne.loadStates),re=ne.setLoaded,ce=function(e,t){B("HERE setForm",t,e),x(e)},oe=function(e){Ct(Ma,Object(p.a)(Object(p.a)({},e),{},{goBack:function(){wt()},currentUrl:(null===C||void 0===C?void 0:C.url)||"none"}))};Object(a.useEffect)((function(){Object(d.a)(u.a.mark((function e(){var t,n,a,r,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.get(D,[]);case 2:return t=e.sent,B("forms",t),re("forms"),s(t),e.next=8,Ka();case 8:if(null!=(n=e.sent)){e.next=14;break}w({title:"None",url:"save-to-notion",icon:null,image:null});try{$a("standalone")||W(!1),(a=$a("formName"))&&(r=t.find((function(e){return er(e.name)==er(a)})))&&ie({id:r.id})}catch(l){B("fail"),W(!1)}return c("choose_form"),e.abrupt("return");case 14:return e.next=16,qe(n.url||"");case 16:if(!(o=e.sent)){e.next=30;break}B("previous state!",o),e.t0=o.pos,e.next="fillForm"===e.t0?22:"settings"===e.t0?26:28;break;case 22:return B("load full form"),R(o.fieldDatas),ie({id:o.formId}),e.abrupt("break",28);case 26:return o.formId?oe({action:"edit",id:o.formId}):oe({action:"new"}),e.abrupt("break",28);case 28:e.next=32;break;case 30:(i=t.find((function(e){return!0===e.favorite})))?ie(i):1==t.length&&ie(t[0]);case 32:w(n),c("choose_form");case 34:case"end":return e.stop()}}),e)})))()}),[]),Object(a.useEffect)((function(){Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}),[]),Object(a.useEffect)((function(){Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!X){e.next=7;break}return Q(!1),e.t0=s,e.next=5,te.get(D,[]);case 5:e.t1=e.sent,(0,e.t0)(e.t1);case 7:case"end":return e.stop()}}),e)})))()}),[X]);var ie=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("loading_select_form"),e.next=3,He(t.id);case 3:n=e.sent,B("end"),ce(n),a=!1,r=0;case 8:if(a){e.next=16;break}if(w((function(e){return W((function(t){return c((function(n){return n.startsWith("error")?(a=!0,n):e&&t?(a=!0,"submit_form"):0==t?"choose_form":"loading_metadatas"})),t})),e})),a){e.next=14;break}return e.next=13,Z(100);case 13:r+=100;case 14:e.next=8;break;case 16:B("waited",r);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=Object(a.useCallback)((function(e){Object(d.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s(e),t.next=3,te.set(D,e);case 3:case"end":return t.stop()}}),t)})))()}),[l]);Object(a.useEffect)((function(){Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ft();case 2:t=e.sent,B("resp",t),"error"==t.status?(F(t.errorMsg),re("notionClient",!1)):(g(t.client),re("notionClient",!0));case 5:case"end":return e.stop()}}),e)})))()}),[]);var ue=Object(a.useCallback)((function(e){var t;27===e.keyCode&&(["INPUT","TEXTAREA"].some((function(e){return e==document.activeElement.tagName.toUpperCase()}))&&(null===(t=document.activeElement)||void 0===t||t.blur(),e.preventDefault()))}),[]);return Object(a.useEffect)((function(){return document.addEventListener("keydown",ue,!1),function(){document.removeEventListener("keydown",ue,!1)}}),[]),r.a.createElement(Qa.Provider,{value:{openOptionsPage:oe,fieldDatas:N,cleanupFieldDatas:function(){return R(null)},currentFormHasChanged:q,formListHasChanged:X,client:b,setCurrentFormHasChanged:J,setFormListHasChanged:Q}},r.a.createElement(Lt,null,{loading_select_form:r.a.createElement(qa,{metadatas:C}),loading_metadatas:r.a.createElement(zn,{msg:"loading metadatas"}),loading:r.a.createElement(zn,null),error_custom:r.a.createElement(Un,{msg:Xa[S]}),choose_form:r.a.createElement(Ja,{connectedToNotion:!("notionClient"in ae)||ae.notionClient,canSavePage:H,forms:l,metadatas:C,onSelectForm:ie,onChangeForms:function(e){le(e),console.log("change order")}}),submit_form:r.a.createElement(Qn,{form:E,metadatas:C,onGoBack:function(){return c("choose_form")},canGoBack:_,onError:function(e){F(e),c("error_custom")},onChangeForm:ce})}[n]))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var nr=n(42),ar=nr.createMuiTheme,rr=nr.ThemeProvider,cr=ar({palette:{primary:{main:"#4F9BC7"},secondary:{main:"hsl(240, 78%, 98%)"}},overrides:{MuiButton:{text:{textTransform:"capitalize","&:hover":{backgroundColor:"rgba(202, 204, 206, 0.4)"}},root:{textTransform:"capitalize"}},MuiChip:{root:{height:"auto",padding:0,borderRadius:"4px"},label:{paddingLeft:"6px",paddingRight:"6px",paddingTop:"4px",paddingBottom:"4px",fontSize:"inherit"}}},props:{MuiTextField:{variant:"outlined",color:"primary",InputLabelProps:{style:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",width:"100%"}}},MuiButton:{variant:"contained",color:"primary"},MuiSelect:{variant:"outlined"},MuiMenu:{anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},getContentAnchorEl:null}}});o.a.render(r.a.createElement(rr,{theme:cr},r.a.createElement(tr,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[161,1,2]]]);
//# sourceMappingURL=main.708646b6.chunk.js.map